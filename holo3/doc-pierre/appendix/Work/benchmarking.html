<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Benchmarking :: Cemosis Docs</title>
    <link rel="canonical" href="https://docs.cemosis.fr/holo3/latest/appendix/Work/benchmarking.html">
    <meta name="generator" content="Antora 2.3.3">
    <link rel="stylesheet" href="../../../../_/css/site.css">
<link rel="icon" href="../../../../_/img/favicon.ico" type="image/x-icon">    
<script>!function(l,p){if(l.protocol!==p&&l.host=="docs.antora.org"){l.protocol=p}else if(/\.gitlab\.io$/.test(l.host)){l.replace(p+"//docs.antora.org"+l.pathname.substr(l.pathname.indexOf("/",1))+l.search+l.hash)}}(location,"https:")</script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$'], ['\\[','\\]']],
    processEscapes: true,
    processEnvironments: true, 
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },

  TeX: {
      Macros: {
      RR: "{\\mathbb R}",
      NN: "{\\mathbb N}",
      Nso: "{N_{\\mathrm{so}}}",
      Nma: "{N_{\\mathrm{ma}}}",
      Nno: "{N_{\\mathrm{no}}}",
      Ne: "{N_{\\mathrm{e}}}",
      Ilag: ["{\\mathcal{I}^{\\mathrm{lag}}_{#1}}",1],
      calTh: "{\\mathcal{T}_h}",
      Ck: ["{\\mathcal{C}^{#1}}",1],
      Pk: ["{\\mathcal{P}^{#1}}",1],
      Qk: ["{\\mathcal{Q}^{#1}}",1],
      Pch: ["{P^{#1}_{c,h}}",1],
      Pcho: ["{P^{#1}_{c,h,0}}",1],
      Qch: ["{Q^{#1}_{c,h}}",1],
      Ich: ["{\\mathcal{I}^{#1}_{c,h}#2}",2],
      poly: ["{\\mathbb{#1}}",1],
      nf: "{n_f}",
      ngeo: "{n_{\\mathrm{geo}}}",
      geo: "{\\mathrm{geo}}",
      card: ["{\\operatorname{card}(#1)}",1],
      dim: ["{\\operatorname{dim}(#1)}",1],
      opdim: "{\\operatorname{dim}}",
      card: ["{\\operatorname{card}(#1)}",1],
      poly: ["{\\mathbb{#1}",1],
      R: ["{\\mathbb{R}^{#1}}",1],
      set: ["{\\left\\{#1\\right\\}}",1],
      diam: "{\\operatorname{diam}}",
      jump: ["{[\\![ #1 ]\\!]}",1],
      Next: "{\\mathrm{n}}",
      essinf: "{\\operatorname{ess}\\, \\operatorname{inf}}",
      tr: "{\\operatorname{tr}}",
      Id: "{\\mathcal{I}}",
      disp: ["{\\mathbf{#1}}",1],
      stresst: ["{\\mathbf{\\sigma(#1)}}",1],
      deformt: ["{\\mathbf{\\varepsilon(#1)}}",1],
      domain: "{\\Omega}",
      prect: ["{\\left\\(#1\\right\\)}",1],
      ds: "",
      bold: ["{\\bf #1}",1],
      p: "{\\mathrm{p}}",
      q:"{\\mathbf{q}}",
      n:"{\\mathbf{n}}",
      T:"{\\mathcal{T}}",
      F:"{\\mathcal{F}}",
      P:"{\\mathcal{P}}",
      v:"{\\mathbf{v}}"
  },
  extensions: ["mhchem.js"] }
});
</script>
<!--<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/MathJax.js?config=TeX-MML-AM_CHTML"></script>-->
<!-- <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML' async></script> -->
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_CHTML'>
</script>
<!--<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.6.0/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>-->

<!--<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0/katex.min.css" integrity="sha384-TEMocfGvRuD1rIAacqrknm5BQZ7W7uWitoih+jMNFXQIbNl16bO8OZmylH/Vi/Ei" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0/katex.min.js" integrity="sha384-jmxIlussZWB7qCuB+PgKG1uLjjxbVVIayPJwi6cG6Zb4YKq0JIw+OMnkkEC7kYCq" crossorigin="anonymous"></script>-->

    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-65761593-2"></script>
    <script>function gtag(){dataLayer.push(arguments)};window.dataLayer=window.dataLayer||[];gtag('js',new Date());gtag('config','UA-65761593-2')</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar  navbar-expand-sm bg-dark navbar-dark">
    <div class="navbar-brand">
      <div class="navbar-item">
         <!--  <a href="https://book.feelpp.org">Feel++ documentation</a> -->
           <a href="https://docs.cemosis.fr">Cemosis Docs</a>
      </div>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://docs.cemosis.fr">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <div class="navbar-link">Docs</div>
          <div class="navbar-dropdown">
            <div class="navbar-item"><strong>Latest Version</strong></div>

            <!-- this code allow to manage ordering of navbar item -->
               
              <a class="navbar-item" href="/cemosis/latest/index.html"> Cemosis Documentation </a>
                  
              <a class="navbar-item" href="/antora-ui-default/index.html"> Cemosis Documentation UI </a>
                  
              <a class="navbar-item" href="/eye2brain/current/index.html"> Eye2Brain Manual </a>
                  
              <a class="navbar-item" href="/feelpp-cfd/latest/index.html"> Feel++ CFD </a>
                  
              <a class="navbar-item" href="/mqs/latest/index.html"> Feel++ Maxwell Quasi Static </a>
                  
              <a class="navbar-item" href="/hemotumpp/0.1/index.html"> HemoTum++ </a>
                  
              <a class="navbar-item" href="/hifimagnet/stable/index.html"> HiFiMagnet Documentation </a>
                  
              <a class="navbar-item" href="/holo3/latest/index.html"> Holo3 </a>
                    
              <a class="navbar-item" href="/ibat/latest/index.html"> IBat Docs </a>
                  
              <a class="navbar-item" href="/msqab/latest/index.html"> msqab </a>
                  
              <a class="navbar-item" href="/swimmer/latest/index.html"> Swimmer Docs </a>
               

            <hr class="navbar-divider">
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <div class="navbar-link">Feel++</div>
          <div class="navbar-dropdown">
            <div class="navbar-item"><strong>GitHub</strong></div>
            <a class="navbar-item" href="http://github.com/feelpp/feelpp">GitHub Repository</a>
            <a class="navbar-item" href="http://github.com/feelpp/feelpp/issues">GitHub Issue Tracker</a>
            <hr class="navbar-divider">
            <div class="navbar-item"><strong>Documentation</strong></div>
            <a class="navbar-item" href="http://docs.feelpp.org/user/">User Manual</a>
            <a class="navbar-item" href="http://docs.feelpp.org/dev/">Developer Manual</a>
            <a class="navbar-item" href="http://docs.feelpp.org/toolbox/">Toolbox Manual</a>
            
          </div>
        </div>
        <div class="primary-action">
            <form class="navbar-item search">
              <input type="text" placeholder="Search Cemosis Docs" class="query" id="search-query">
              <button type="button" class="search-btn"><i class="fas fa-search"></i></button>
            </form>
        </div>
        <div class="navbar-item">
          <a class="navbar-brand" href="https://join.slack.com/t/feelpp/shared_invite/zt-2qe0q9hw-4pVbhohCXUE6Po9Ma8dbiQ">
            <img src="../../../../_/img/slack.png" alt="slack" style="width:30px;"></a>
        </div>
        <div class="navbar-item">
          <a class="navbar-brand"  href="http://docs.feelpp.org">
            <img src="../../../../_/img/logoFeelpp.png" alt="Feel++" style="width:60px;">
          </a>
        </div>
        <div class="navbar-item">
          <a class="navbar-brand"  href="http://www.cemosis.fr">
            <img src="../../../../_/img/logoCemosisTransparent.png" alt="Cemosis" style="width:60px;">
          </a>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="holo3" data-version="doc-pierre">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../index.html">Holo3</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../modeling/deflectometry.html">Introduction</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../polymap/polymap.html">Polymap</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../methodology/index.html">Methodology</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Domain Definition</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../methodology/uniformmesh.html">Uniform mesh</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../methodology/deformedmesh.html">Deformed mesh</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../methodology/meshpoly.html">Mesh extraction with polygons</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../methodology/meshls.html">Mesh extraction with levelset</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Reconstruction</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../methodology/problemformulation.html">Problem formulation</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../methodology/meshoptimization.html">Mesh optimization</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../methodology/nonlinearproblem.html">Non linear problem</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../methodology/solver.html">Solver</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../methodology/serialcontrol.html">Serial control</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Data Selection</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../indicators/indicators.html">Indicators</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../indicators/low-contrast.html">Low Contrast</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../indicators/phase-spike.html">Phase Spike</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../indicators/phase-border.html">Phase Border</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../indicators/combine.html">Indicators combined</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#methodology/mesureetalon.adoc">Mesure Etalon</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../client-server/index.html">Client Server</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Numerical Experiments</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../experiments/serialbench.html">Serial Benchmark</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../experiments/standardbench.html">Standard Benchmark</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../experiments/testsuite.html">Testsuite</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../experiments/validation.html">Validation</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Report</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../report/report.html">Report 2020</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Holo3</span>
    <span class="version">doc-pierre</span>
  </div>
  <ul class="components">
    <li class="component">
      <span class="title">Cemosis Documentation</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../cemosis/latest/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Cemosis Documentation UI</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../antora-ui-default/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Eye2Brain Manual</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../eye2brain/current/index.html">current</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Feel++ CFD</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../feelpp-cfd/latest/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Feel++ Maxwell Quasi Static</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../mqs/latest/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">HemoTum++</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../hemotumpp/0.1/index.html">0.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">HiFiMagnet Documentation</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../hifimagnet/stable/index.html">stable</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <span class="title">Holo3</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../latest/index.html">latest</a>
        </li>
        <li class="version is-current">
          <a href="../../index.html">doc-pierre</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">IBat Docs</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../ibat/latest/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">msqab</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../msqab/latest/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Swimmer Docs</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../swimmer/latest/index.html">latest</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../../cemosis/latest/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../index.html">Holo3</a></li>
    <li><a href="benchmarking.html">Benchmarking</a></li>
  </ul>
</nav>
<div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">doc-pierre</button>
  <div class="version-menu">
    <a class="version" href="../../../latest/appendix/Work/benchmarking.html">latest</a>
    <a class="version is-current" href="benchmarking.html">doc-pierre</a>
  </div>
</div>
</div>
  <div class="content">
<article class="doc">
<h1 class="page">Benchmarking</h1>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_surface_rec">1. Surface rec</a>
<ul class="sectlevel2">
<li><a href="#_processor_numbers_scalability">1.1. Processor numbers scalability</a></li>
<li><a href="#_image_size_scalability">1.2. Image size scalability</a></li>
</ul>
</li>
<li><a href="#_serial_control">2. Serial control</a>
<ul class="sectlevel2">
<li><a href="#_processor_numbers_scalability_2">2.1. Processor numbers scalability</a></li>
<li><a href="#_image_size_scalability_2">2.2. Image size scalability</a></li>
<li><a href="#_case_number_scalability">2.3. Case number scalability</a></li>
<li><a href="#_conclusion">2.4. Conclusion</a></li>
</ul>
</li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This part will be dedicate to different benchmarkings for our two main applications : surface_rec and serial_control. They are linked to the resolution of the following equation :</p>
</div>
<div class="paragraph">
<p>
\int_\Omega \nabla z \cdot \nabla v = \int_\Omega(p,q)\cdot\nabla v
</p>
</div>
<div class="paragraph">
<p>The default data we will be using here are as follows :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Image size : 1280*960</p>
</li>
<li>
<p>Number of processors : 4</p>
</li>
<li>
<p>Number of case : 4 ( only for serial_control )</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>All the test are realised with the ML preconditionner, on the <a href="https://github.com/feelpp/feelpp/wiki/Irma-Atlas-Cluster">Irma Atlas Cluster</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_surface_rec"><a class="anchor" href="#_surface_rec"></a>1. Surface rec</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As a reminder, the surface_rec application allows us to obtain the height of a surface from the derivates following x and y axis. Things we are especially interested in here are how the application time completion react from different number of processors used or differents image sizes.</p>
</div>
<div class="paragraph">
<p>The program can be decomposed into main parts :</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Mesh</strong> correspond at the time need to build the mesh ( nodes and elements ) and prepare it to use.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">auto mesh = boost::make_shared&lt;MeshStructured&gt;( ioption("Scala")*(x.rows()),
                                                ioption("Scala")*(x.cols()),
                                                doption(_name="pixelsize"),
                                                Environment::worldComm() );
mesh-&gt;components().reset();
mesh-&gt;components().set( size_type(MESH_UPDATE_ELEMENTS_ADJACENCY|MESH_NO_UPDATE_MEASURES) );
mesh-&gt;updateForUse();</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Vh</strong> is the part where we built the function space, used for defining elements ( test and trial ).</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">auto Vh = Pch&lt;1&gt; ( mesh ) ;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Elements</strong> is the build of the trial and test elements, as well that we will browse trough the mesh, as well as "data" elements, which will help us to define our problem.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">auto u = Vh-&gt;element () ;
auto v = Vh-&gt;element () ;
auto px = Vh-&gt;element () ;
auto py = Vh-&gt;element () ;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>HbfToFeel</strong> is the time needed to transfer the data from the hbf files into our "data" elements</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">Hbf2FeelppStruc h2f( nx, ny, Vh );</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>rhs</strong> and <strong>lhs</strong> are respectively the build of the right ( linear ) and left ( bilinear ) side of our equation problem.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">auto l = form1( _test=Vh );
l = integrate(_range=elements(mesh),
              _expr=grad(v)*vec(idv(px),idv(py)));

auto a = form2( _trial=Vh, _test=Vh);
a = integrate( _range=elements(mesh),
               _expr=gradt(u)*trans(grad(v)));</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Finally the <strong>solver</strong> part is the time need to solve our equation , with possible conditions to take in account.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">a.solve(_rhs=l,_solution=u,_post=zeromean)</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_processor_numbers_scalability"><a class="anchor" href="#_processor_numbers_scalability"></a>1.1. Processor numbers scalability</h3>
<div class="paragraph">
<p>The first one we will observe is the processor numbers interactions with the necessary time for the application to finish. We will choose an image with 1280\times 960 size as a referent for these tests.</p>
</div>
<div class="paragraph">
<div class="title">Time for different numbers of processors used</div>
<p><span class="image"><img src="../../Pictures/BenProcSur.png" alt="Time for different number of processors used" width="550"></span></p>
</div>
<div class="paragraph">
<p>As we can see, we start from approximatly 70 s in sequential to less than 10 s with 16 processors.</p>
</div>
</div>
<div class="sect2">
<h3 id="_image_size_scalability"><a class="anchor" href="#_image_size_scalability"></a>1.2. Image size scalability</h3>
<div class="paragraph">
<div class="title">Time for different sizes of images</div>
<p><span class="image"><img src="../../Pictures/BenchSizeSur.png" alt="Time for different size of given images" width="550"></span></p>
</div>
<div class="paragraph">
<p>As expect, the time rise up as the size of slope data also grow up
The mesh creation is particuliary touch by this effect, as well as the right side member build.</p>
</div>
<div class="paragraph">
<div class="title">Time for different sizes of images</div>
<p><span class="image"><img src="../../Pictures/BenchStrongSur.png" alt="Time for different number of processors, proportionnaly to sizes of given images" width="550"></span></p>
</div>
<div class="paragraph">
<p>For this second part, we test the weak scalabilty of our program, i.e. if the time need is conserved when the slopes data sizes and the number of processors used increase the same way ( in this case \times 4  ).
The two first results seems pretty good as the time difference is small between them. However, the time explodes for the last one.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_serial_control"><a class="anchor" href="#_serial_control"></a>2. Serial control</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In the case of the serial control application, we would like to pass trough multiple sets of slope datas, with the same principal aspect, such as image size or area of interest.</p>
</div>
<div class="paragraph">
<p>The program can be decomposed into main parts :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The initial initialization</p>
<div class="ulist">
<ul>
<li>
<p><strong>Mesh</strong> correspond at the time need to build the mesh ( nodes and elements ) and prepare it to use.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">auto mesh = boost::make_shared&lt;MeshStructured&gt;( ioption("Scala")*(x.rows()),
                                                ioption("Scala")*(x.cols()),
                                                doption(_name="pixelsize"),
                                                Environment::worldComm() );
mesh-&gt;components().reset();
mesh-&gt;components().set( size_type(MESH_UPDATE_ELEMENTS_ADJACENCY|MESH_NO_UPDATE_MEASURES) );
mesh-&gt;updateForUse();</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Vh</strong> is the part where we built the function space, used for defining elements ( test and trial ).</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">auto Vh = Pch&lt;1&gt; ( mesh ) ;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Elements</strong> is the build of the trial and test elements, as well that we will browse trough the mesh, as well as "data" elements, which will help us to define our problem.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">auto u = Vh-&gt;element () ;
auto v = Vh-&gt;element () ;
auto px = Vh-&gt;element () ;
auto py = Vh-&gt;element () ;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>HbfToFeel</strong> is the time to build the object that will allow us to transfer the data from the hbf files into our "data" elements.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">Hbf2FeelppStruc h2f( nx, ny, Vh );</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>lhs</strong> is the build of the left ( bilinear ) side of our equation problem.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">auto a = form2( _trial=Vh, _test=Vh);
a = integrate( _range=elements(mesh),
               _expr=gradt(u)*trans(grad(v)));</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>The loop ( A complete loop is reffered as <strong>Set</strong> )</p>
<div class="ulist">
<ul>
<li>
<p><strong>rhs</strong> is the build of the right ( bilinear ) side of our equation problem.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">x = readHBF( Environment::expand("${holo3_srcdir}/data/surface_reconstruction/input/Issue1/Surface_Basis/Dxsurface"+std::to_string(i)+".hbf") );

y = readHBF( Environment::expand("${holo3_srcdir}/data/surface_reconstruction/input/Issue1/Surface_Basis/Dysurface"+std::to_string(i)+".hbf") );

px = h2f( x, px );
py = h2f( y, py );

auto l= form1( _test=Vh );
l = integrate(_range=elements(mesh),
              _expr=grad(v)*vec(idv(px),idv(py)));</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>The <strong>solver</strong> part is the time need to solve our equation , with possible conditions to take in account.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">a.solve(_rhs=l,_solution=u,_post=zeromean)</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_processor_numbers_scalability_2"><a class="anchor" href="#_processor_numbers_scalability_2"></a>2.1. Processor numbers scalability</h3>
<div class="paragraph">
<p>Just like the previous application, we want to determine here how the time consumption will evolve when the number of processor used or the size of the images will change, but also, in this particular case, with the number of image set ( aka case ) the application must resolve.</p>
</div>
<div class="paragraph">
<div class="title">Time for different number of processors used</div>
<p><span class="image"><img src="../../Pictures/BenProcSerial.png" alt="Time for different number of processors used" width="550"></span></p>
</div>
<div class="paragraph">
<p>To resolve four cases in a row, we pass to 140 s in sequential to approximatly 20 s with 16 processors.</p>
</div>
</div>
<div class="sect2">
<h3 id="_image_size_scalability_2"><a class="anchor" href="#_image_size_scalability_2"></a>2.2. Image size scalability</h3>
<div class="paragraph">
<div class="title">Time for different sizes of images</div>
<p><span class="image"><img src="../../Pictures/BenchSizeSerial.png" alt="Time for different size of given images" width="550"></span></p>
</div>
<div class="paragraph">
<p>Just as the first program, time react as exepected when slope data size is increased.</p>
</div>
<div class="paragraph">
<div class="title">Time for different sizes of images</div>
<p><span class="image"><img src="../../Pictures/BenchWeakSerial.png" alt="Time for different number of processors, proportionnaly to sizes of given images" width="550"></span></p>
</div>
<div class="paragraph">
<p>For the weak scalability, we retrieve the same pattern as before. The first two test are pretty similar and the difference is so slim. However at the third case, time increase again drastically.</p>
</div>
<div class="paragraph">
<p><strong>NOTE</strong> : For the third case, the program cannot finish to solve all the case ( four ) at the moment. The time of cases solve is so appraoch from time data we have ( firsts solve completed )</p>
</div>
</div>
<div class="sect2">
<h3 id="_case_number_scalability"><a class="anchor" href="#_case_number_scalability"></a>2.3. Case number scalability</h3>
<div class="paragraph">
<div class="title">Average Time</div>
<p><span class="image"><img src="../../Pictures/BenchAverSerial.png" alt="Average Time with multiple cases" width="550"></span></p>
</div>
<div class="paragraph">
<p>We saw here that, with four processors, we have an average time equals to 7s for resolve one case.</p>
</div>
<div class="paragraph">
<p>The average time need for one case, aka one set of data and the resolution, don&#8217;t change whatever number of cases wanted, without taking in consideration possible other actions on processors.</p>
</div>
</div>
<div class="sect2">
<h3 id="_conclusion"><a class="anchor" href="#_conclusion"></a>2.4. Conclusion</h3>
<div class="paragraph">
<p>Let&#8217;s begin with the processor scalability, also named the strong scalabilty : as the graphes from the surface reconstruction program or the serial control one, the scalability isn&#8217;t perfect as we progress to the number of processors used.</p>
</div>
<div class="paragraph">
<p>We can denote as great reduce of time needed at the beginning, notably where we pass from sequential to parallel with 2 processors. We can see here nearly a cut by two of the time.</p>
</div>
<div class="paragraph">
<p>But as much as we go forward, this reduce start to shrink and become smaller and smaller. We loose then the proportional nature we had between the increase of processors and the tim reduce.</p>
</div>
<div class="paragraph">
<p>In fact, some parts, such as the solver part, aren&#8217;t reduce as much to keep this by using more processors.</p>
</div>
<div class="paragraph">
<p>Then, jump on the scalabilty from differents data sizes. In this case, we can see in a first part, and for each case, that if we multiply by four the global size ( time two in each direction ), the size is approximatly four times more than the last one.</p>
</div>
<div class="paragraph">
<p>We can also observe the weak scalability, i.e. increase the size proportionality to the number of processors used. In this type of configuration, we observe times obtained seems close enough, for the two first sizes cases.</p>
</div>
<div class="paragraph">
<p>However at the third one, time take off quickly. All the part of the program take more time to be complete, with mesh construction and equation constrution and resolution in particular.</p>
</div>
</div>
</div>
</div>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>

  </div>
</main>
</div>
<footer class="footer">
  <div class="container">
    <div class="footer-links">
      <div class="col">
        <div class="footer-logo">
          <a href="https://www.cemosis.fr" class="icon">
            <img src="../../../../_/img/logoCemosisTransparent.png" alt="Cemosis">
          </a>
        </div>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://docs.cemosis.fr" target="_blank" rel="noopener">Projects Documentation</a></li>
          <li><a href="https://join.slack.com/t/feelpp/shared_invite/zt-2qe0q9hw-4pVbhohCXUE6Po9Ma8dbiQ" target="_blank" rel="noopener">Forums(Slack)</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://www.cemosis.fr" target="_blank" rel="noopener">Cemosis</a></li>
          <li><a href="https://www.cemosis.fr/news" target="_blank" rel="noopener">News</a></li>
          <li><a href="https://www.cemosis.fr/projects" target="_blank" rel="noopener">Projects</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://docs.feelpp.org" target="_blank" rel="noopener">Feel++ Documentation</a></li>
          <li><a href="http://docs.feelpp.org/user/">Get Started</a></li>
          <li><a href="http://docs.feelpp.org/user//install/distributions/">Downloads</a></li>
        </ul>
      </div>
      <div class="col">
        <ul class="social-icons">
          <li>
            <svg  width="14" height="14" viewBox="0 0 32 32"> <path id="facebook" class="cls-1" d="M29,0H3A2.652,2.652,0,0,0,0,3V29a2.652,2.652,0,0,0,3,3H16V18H12V14h4V12a6.452,6.452,0,0,1,6-6h4v4H22a2.151,2.151,0,0,0-2,2v2h6l-1,4H20V32h9a2.652,2.652,0,0,0,3-3V3A2.652,2.652,0,0,0,29,0Z"/></svg>
            <a href="https://www.facebook.com/cemosis.fr" class="icon">
            Facebook
            </a>
          </li>
          <li>
            <svg  width="14" height="14" viewBox="0 0 32.1 26.1"> <path id="twitter" class="cls-1" d="M32,7.1a11.836,11.836,0,0,1-3.8,1,6.462,6.462,0,0,0,2.9-3.6,12.606,12.606,0,0,1-4.2,1.6A6.492,6.492,0,0,0,22.1,4a6.594,6.594,0,0,0-6.6,6.6,7.719,7.719,0,0,0,.2,1.5A18.458,18.458,0,0,1,2.2,5.2a6.294,6.294,0,0,0-.9,3.3A6.765,6.765,0,0,0,4.2,14a6.109,6.109,0,0,1-3-.8v.1a6.543,6.543,0,0,0,5.3,6.4,4.678,4.678,0,0,1-1.7.2,4.869,4.869,0,0,1-1.2-.1,6.679,6.679,0,0,0,6.1,4.6,12.917,12.917,0,0,1-8.2,2.8,9.151,9.151,0,0,1-1.6-.1,18.438,18.438,0,0,0,10.1,3c12.1,0,18.7-10,18.7-18.7v-.8A13.336,13.336,0,0,0,32,7.2Z" transform="translate(0.1 -4)"/></svg>
            <a href="https://twitter.com/cemosis" class="icon">
              Twitter
            </a>
          </li>
          <li>
          <svg  width="14" height="14" viewBox="0 0 32 32"> <path id="linkedin" class="cls-1" d="M29,0H3A3.076,3.076,0,0,0,0,3V29a3.009,3.009,0,0,0,3,3H29a2.946,2.946,0,0,0,3-3V3A3.009,3.009,0,0,0,29,0ZM12,26H8V12h4ZM10,10a2,2,0,1,1,2-2A2.006,2.006,0,0,1,10,10ZM26,26H22V18a2,2,0,0,0-4,0v8H14V12h4v2.5c.8-1.1,2.1-2.5,3.5-2.5A4.736,4.736,0,0,1,26,17Z"/></svg>
              <a href="https://www.linkedin.com/company/cemosis" class="icon">
             Linkedin
            </a>
          </li>
        </ul>
      </div>
    </div>
    <div class="footer-terms">
      <div class="footer-terms-copyright">
          <span>© 2020 Cemosis, Université de Strasbourg</span>
      </div>
      <div class="footer-terms-links">
        <a href="https://www.cemosis.fr/terms-of-use">Terms of Use</a>
        <a href="https://www.cemosis.fr/privacy-policy">Privacy Policy</a>
        <a href="https://www.cemosis.fr/cookie-policy">Cookie Policy</a>
        <a href="https://www.cemosis.fr/support-policy">Support Policy</a>
      </div>
    </div>
  </div>
</footer>
<script src="../../../../_/js/site.js"></script>
<script async src="../../../../_/js/vendor/fontawesome-icon-defs.js"></script>
<script async src="../../../../_/js/vendor/fontawesome.js"></script>
<script async src="../../../../_/js/vendor/highlight.js"></script>

<script async id="search-script" src="../../../../_/js/vendor/docsearch.js" data-app-id="FIPLENFG5M" data-api-key="489d96aa4ae574ec7ad1f23741a2d46d" data-index-name="cemosis" data-stylesheet="../../../../_/css/vendor/docsearch.css">
</script>

  </body>
</html>
