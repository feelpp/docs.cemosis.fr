<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Indicators :: Cemosis Docs</title>
    <link rel="canonical" href="https://docs.cemosis.fr/holo3/latest/methodology/indicators.html">
    <meta name="generator" content="Antora 2.3.3">
    <link rel="stylesheet" href="../../../_/css/site.css">
<link rel="icon" href="../../../_/img/favicon.ico" type="image/x-icon">    
<script>!function(l,p){if(l.protocol!==p&&l.host=="docs.antora.org"){l.protocol=p}else if(/\.gitlab\.io$/.test(l.host)){l.replace(p+"//docs.antora.org"+l.pathname.substr(l.pathname.indexOf("/",1))+l.search+l.hash)}}(location,"https:")</script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$'], ['\\[','\\]']],
    processEscapes: true,
    processEnvironments: true, 
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },

  TeX: {
      Macros: {
      RR: "{\\mathbb R}",
      NN: "{\\mathbb N}",
      Nso: "{N_{\\mathrm{so}}}",
      Nma: "{N_{\\mathrm{ma}}}",
      Nno: "{N_{\\mathrm{no}}}",
      Ne: "{N_{\\mathrm{e}}}",
      Ilag: ["{\\mathcal{I}^{\\mathrm{lag}}_{#1}}",1],
      calTh: "{\\mathcal{T}_h}",
      Ck: ["{\\mathcal{C}^{#1}}",1],
      Pk: ["{\\mathcal{P}^{#1}}",1],
      Qk: ["{\\mathcal{Q}^{#1}}",1],
      Pch: ["{P^{#1}_{c,h}}",1],
      Pcho: ["{P^{#1}_{c,h,0}}",1],
      Qch: ["{Q^{#1}_{c,h}}",1],
      Ich: ["{\\mathcal{I}^{#1}_{c,h}#2}",2],
      poly: ["{\\mathbb{#1}}",1],
      nf: "{n_f}",
      ngeo: "{n_{\\mathrm{geo}}}",
      geo: "{\\mathrm{geo}}",
      card: ["{\\operatorname{card}(#1)}",1],
      dim: ["{\\operatorname{dim}(#1)}",1],
      opdim: "{\\operatorname{dim}}",
      card: ["{\\operatorname{card}(#1)}",1],
      poly: ["{\\mathbb{#1}",1],
      R: ["{\\mathbb{R}^{#1}}",1],
      set: ["{\\left\\{#1\\right\\}}",1],
      diam: "{\\operatorname{diam}}",
      jump: ["{[\\![ #1 ]\\!]}",1],
      Next: "{\\mathrm{n}}",
      essinf: "{\\operatorname{ess}\\, \\operatorname{inf}}",
      tr: "{\\operatorname{tr}}",
      Id: "{\\mathcal{I}}",
      disp: ["{\\mathbf{#1}}",1],
      stresst: ["{\\mathbf{\\sigma(#1)}}",1],
      deformt: ["{\\mathbf{\\varepsilon(#1)}}",1],
      domain: "{\\Omega}",
      prect: ["{\\left\\(#1\\right\\)}",1],
      ds: "",
      bold: ["{\\bf #1}",1],
      p: "{\\mathrm{p}}",
      q:"{\\mathbf{q}}",
      n:"{\\mathbf{n}}",
      T:"{\\mathcal{T}}",
      F:"{\\mathcal{F}}",
      P:"{\\mathcal{P}}",
      v:"{\\mathbf{v}}"
  },
  extensions: ["mhchem.js"] }
});
</script>
<!--<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/MathJax.js?config=TeX-MML-AM_CHTML"></script>-->
<!-- <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML' async></script> -->
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_CHTML'>
</script>
<!--<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.6.0/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>-->

<!--<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0/katex.min.css" integrity="sha384-TEMocfGvRuD1rIAacqrknm5BQZ7W7uWitoih+jMNFXQIbNl16bO8OZmylH/Vi/Ei" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0/katex.min.js" integrity="sha384-jmxIlussZWB7qCuB+PgKG1uLjjxbVVIayPJwi6cG6Zb4YKq0JIw+OMnkkEC7kYCq" crossorigin="anonymous"></script>-->

    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-65761593-2"></script>
    <script>function gtag(){dataLayer.push(arguments)};window.dataLayer=window.dataLayer||[];gtag('js',new Date());gtag('config','UA-65761593-2')</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar  navbar-expand-sm bg-dark navbar-dark">
    <div class="navbar-brand">
      <div class="navbar-item">
         <!--  <a href="https://book.feelpp.org">Feel++ documentation</a> -->
           <a href="https://docs.cemosis.fr">Cemosis Docs</a>
      </div>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://docs.cemosis.fr">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <div class="navbar-link">Docs</div>
          <div class="navbar-dropdown">
            <div class="navbar-item"><strong>Latest Version</strong></div>

            <!-- this code allow to manage ordering of navbar item -->
               
              <a class="navbar-item" href="/cemosis/latest/index.html"> Cemosis Documentation </a>
                  
              <a class="navbar-item" href="/antora-ui-default/index.html"> Cemosis Documentation UI </a>
                  
              <a class="navbar-item" href="/eye2brain/current/index.html"> Eye2Brain Manual </a>
                  
              <a class="navbar-item" href="/feelpp-cfd/latest/index.html"> Feel++ CFD </a>
                  
              <a class="navbar-item" href="/mqs/latest/index.html"> Feel++ Maxwell Quasi Static </a>
                  
              <a class="navbar-item" href="/hemotumpp/0.1/index.html"> HemoTum++ </a>
                  
              <a class="navbar-item" href="/holo3/latest/index.html"> Holo3 </a>
                    
              <a class="navbar-item" href="/ibat/latest/index.html"> IBat </a>
                  
              <a class="navbar-item" href="/msqab/0.1/index.html"> msqab </a>
                  
              <a class="navbar-item" href="/swimmer/latest/index.html"> Swimmer Docs </a>
               

            <hr class="navbar-divider">
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <div class="navbar-link">Feel++</div>
          <div class="navbar-dropdown">
            <div class="navbar-item"><strong>GitHub</strong></div>
            <a class="navbar-item" href="http://github.com/feelpp/feelpp">GitHub Repository</a>
            <a class="navbar-item" href="http://github.com/feelpp/feelpp/issues">GitHub Issue Tracker</a>
            <hr class="navbar-divider">
            <div class="navbar-item"><strong>Documentation</strong></div>
            <a class="navbar-item" href="http://docs.feelpp.org/user/">User Manual</a>
            <a class="navbar-item" href="http://docs.feelpp.org/dev/">Developer Manual</a>
            <a class="navbar-item" href="http://docs.feelpp.org/toolbox/">Toolbox Manual</a>
            
          </div>
        </div>
        <div class="primary-action">
            <form class="navbar-item search">
              <input type="text" placeholder="Search Cemosis Docs" class="query" id="search-query">
              <button type="button" class="search-btn"><i class="fas fa-search"></i></button>
            </form>
        </div>
        <div class="navbar-item">
          <a class="navbar-brand" href="https://join.slack.com/t/feelpp/shared_invite/zt-2qe0q9hw-4pVbhohCXUE6Po9Ma8dbiQ">
            <img src="../../../_/img/slack.png" alt="slack" style="width:30px;"></a>
        </div>
        <div class="navbar-item">
          <a class="navbar-brand"  href="http://docs.feelpp.org">
            <img src="../../../_/img/logoFeelpp.png" alt="Feel++" style="width:60px;">
          </a>
        </div>
        <div class="navbar-item">
          <a class="navbar-brand"  href="http://www.cemosis.fr">
            <img src="../../../_/img/logoCemosisTransparent.png" alt="Cemosis" style="width:60px;">
          </a>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="holo3" data-version="doc-pierre">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Holo3</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../modeling/deflectometry.html">Introduction</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../polymap/polymap.html">Polymap</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="index.html">Methodology</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Domain Definition</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="uniformmesh.html">Uniform mesh</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="deformedmesh.html">Deformed mesh</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="meshpoly.html">Mesh extraction with polygons</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="meshls.html">Mesh extraction with levelset</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Reconstruction</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="problemformulation.html">Problem formulation</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="meshoptimization.html">Mesh optimization</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="nonlinearproblem.html">Non linear problem</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="solver.html">Solver</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="serialcontrol.html">Serial control</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Data Selection</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../indicators/indicators.html">Indicators</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../indicators/low-contrast.html">Low Contrast</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../indicators/phase-spike.html">Phase Spike</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../indicators/phase-border.html">Phase Border</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../indicators/combine.html">Indicators combined</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#methodology/mesureetalon.adoc">Mesure Etalon</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../client-server/index.html">Client Server</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Numerical Experiments</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../experiments/serialbench.html">Serial Benchmark</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../experiments/standardbench.html">Standard Benchmark</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../experiments/testsuite.html">Testsuite</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../experiments/validation.html">Validation</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Report</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../report/report.html">Report 2020</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Holo3</span>
    <span class="version">doc-pierre</span>
  </div>
  <ul class="components">
    <li class="component">
      <span class="title">Cemosis Documentation</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../cemosis/latest/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Cemosis Documentation UI</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../antora-ui-default/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Eye2Brain Manual</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../eye2brain/current/index.html">current</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Feel++ CFD</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../feelpp-cfd/latest/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Feel++ Maxwell Quasi Static</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../mqs/latest/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">HemoTum++</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../hemotumpp/0.1/index.html">0.1</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <span class="title">Holo3</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../latest/index.html">latest</a>
        </li>
        <li class="version is-current">
          <a href="../index.html">doc-pierre</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">IBat</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../ibat/latest/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">msqab</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../msqab/0.1/index.html">0.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Swimmer Docs</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../swimmer/latest/index.html">latest</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../cemosis/latest/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Holo3</a></li>
    <li><a href="indicators.html">Indicators</a></li>
  </ul>
</nav>
<div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">doc-pierre</button>
  <div class="version-menu">
    <a class="version" href="../../latest/methodology/indicators.html">latest</a>
    <a class="version is-current" href="indicators.html">doc-pierre</a>
  </div>
</div>
</div>
  <div class="content">
<article class="doc">
<h1 class="page">Indicators</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>The information on each pixel is not always reliable. From Post-processing data only (unwrapped phase files and contrasts files), we can know detect most of them by creating few indicators (boolean maps). We will study each of this indicators by talking about the example of the Etalon from angle 30°.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/indicators/mesureEtalonAngle30.png" alt="Average Contrast">
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>To compute indicators on a study case, it needs to have Post-Proc Datas.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Following indicators results were found with the command line :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./feelpp_h3_surface_rec --polymap.study surface_rec/mesureEtalon2020/angle30 --polymap.pmean=1 --polymap.export.paraview=true --polymap.indicators=true</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_1_low_contrast"><a class="anchor" href="#_1_low_contrast"></a>1. 1 - Low contrast</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Since the intensity depends of the phase <strong>except when the reflection of the screen goes outside of the camera</strong>, points on the surface that have an phase-independent intensity (meaning a low contrast) are corrupted and not reliable.</p>
</div>
<div class="paragraph">
<p>Moreover, a rough surface will make the camera pixel to see multiple screen pixels by reflexion, making once again the intensity phase-independent and the contrast low.</p>
</div>
<div class="paragraph">
<p>A threshold allows us to tell whether a point has a low contrast or not.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">image_t Dcontrast_ = image_t::Zero( nrows, ncols ); <i class="conum" data-value="1"></i><b>(1)</b>

image_t cxy = (cx.array()+cy.array())/2; <i class="conum" data-value="2"></i><b>(2)</b>

auto r = cxy.mean();
auto R = ( r*r + r )/2.; <i class="conum" data-value="3"></i><b>(3)</b>

auto cxy_row { cxy.reshaped() };
std::sort( cxy_row.begin(), cxy_row.end() );
auto med = cxy_row.size() % 2 == 0 ?
        cxy_row.segment( (cxy_row.size()-2)/2, 2 ).mean() :
        cxy_row( cxy_row.size()/2 ); <i class="conum" data-value="4"></i><b>(4)</b>

image_t greaterThanR = (cxy.array() &gt; R).select(cxy, matrix_1.array()*med); <i class="conum" data-value="5"></i><b>(5)</b>

r = greaterThanR.mean();
R = ( r*r + r )/2.; <i class="conum" data-value="6"></i><b>(6)</b>

Dcontrast_ = (cxy.array() &gt; R).select(matrix_1, matrix_0); <i class="conum" data-value="7"></i><b>(7)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Construction of a map with 0 everywhere</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Mean of horizontal and vertical contrast for each point</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>First threshold computed with every data even corrupted one</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Compute the median of every coefficient of the matrix</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Rough selection to make a second threshold without the corrupted data (replacing potentially corrupted data by the median value)</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Second threshold not corrupted by corrupted data</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>Final selection</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Steps (1), (2), (4), (6) and every mean computed were written to harness the strength of <strong>Eigen libraries</strong> that are more efficient than an explicit loop <strong>for</strong> or <strong>while</strong> on every coefficient of the matrices.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/indicators/LC1/LC1_contrast.png" alt="Average Contrast">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/indicators/LC1/LC1_result.png" alt="Result Contrast">
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Something is obviously wrong with this indicator but more generally, it is implemented to detect the lowest contrasts of the picture, not the contrasts too close to 0 (as said above, problematic pixels have exactly a 0 contrast)</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">Dcontrast_ = (cxy.array() &gt; R).select(matrix_1, matrix_0); <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Alternative : a threshold data-independent</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/indicators/LC2/LC_surface.png" alt="LC surface">
</div>
<div class="title">Figure 1. Suspect Area</div>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/indicators/LC2/LC_contrast.png" alt="LC contrast">
</div>
<div class="title">Figure 2. Average Contrast on this Area</div>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/indicators/LC2/LC_result.png" alt="LC result">
</div>
<div class="title">Figure 3. Result</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_2_overexposure"><a class="anchor" href="#_2_overexposure"></a>2. 2 - Overexposure</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When studying complex surfaces, to be able to see the whole surface even the darkest areas, we need to increase the luminosity even if it means to overexpose some areas.</p>
</div>
<div class="paragraph">
<p>This choice introduces a noise on phase data. However this noise is known to be \(2nπ\). Therefore it is easy to detect, we just need to detect when the difference between two neighboring pixels is greater than \(2π\)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">        image_t DphaseSpike_ = image_t::Zero( nrows, ncols ); <i class="conum" data-value="1"></i><b>(1)</b>

        image_t pxU = image_t::Zero(nrows_, ncols_); // U = Up
        image_t pxR = image_t::Zero(nrows_, ncols_); // R = Right
        image_t pxD = image_t::Zero(nrows_, ncols_); // D = Down
        image_t pxL = image_t::Zero(nrows_, ncols_); // L = Left

        image_t pxUR = image_t::Zero(nrows_, ncols_);
        image_t pxDR = image_t::Zero(nrows_, ncols_);
        image_t pxDL = image_t::Zero(nrows_, ncols_);
        image_t pxUL = image_t::Zero(nrows_, ncols_);<i class="conum" data-value="2"></i><b>(2)</b>

        pxU.block(1, 0, nrows_-1, ncols_) = (px.array().block(0, 0, nrows_-1, ncols_));
        pxR.block(0, 0, nrows_, ncols_-1) = (px.array().block(0, 1, nrows_, ncols_-1));
        pxD.block(0, 0, nrows_-1, ncols_) = (px.array().block(1, 0, nrows_-1, ncols_));
        pxL.block(0, 1, nrows_, ncols_-1) = (px.array().block(0, 0, nrows_, ncols_-1));

        pxUR.block(1, 0, nrows_-1, ncols_-1) = (px.array().block(0, 1, nrows_-1, ncols_-1));
        pxDR.block(0, 0, nrows_-1, ncols_-1) = (px.array().block(1, 1, nrows_-1, ncols_-1));
        pxDL.block(0, 1, nrows_-1, ncols_-1) = (px.array().block(1, 0, nrows_-1, ncols_-1));
        pxUL.block(1, 1, nrows_-1, ncols_-1) = (px.array().block(0, 0, nrows_-1, ncols_-1));<i class="conum" data-value="3"></i><b>(3)</b>


        image_t dpxU = image_t::Zero(nrows_, ncols_);
        image_t dpxR = image_t::Zero(nrows_, ncols_);
        image_t dpxD = image_t::Zero(nrows_, ncols_);
        image_t dpxL = image_t::Zero(nrows_, ncols_);
        image_t dpxUR = image_t::Zero(nrows_, ncols_);
        image_t dpxDR = image_t::Zero(nrows_, ncols_);
        image_t dpxDL = image_t::Zero(nrows_, ncols_);
        image_t dpxUL = image_t::Zero(nrows_, ncols_);


        dpxU = (px.array()-pxU.array()).abs();
        dpxR = (px.array()-pxR.array()).abs();
        dpxD = (px.array()-pxD.array()).abs();
        dpxL = (px.array()-pxL.array()).abs();

        dpxUR = (px.array()-pxUR.array()).abs();
        dpxDR = (px.array()-pxDR.array()).abs();
        dpxDL = (px.array()-pxDL.array()).abs();
        dpxUL = (px.array()-pxUL.array()).abs();<i class="conum" data-value="4"></i><b>(4)</b>

        image_t dpxMean = (dpxU.array() + dpxR.array() + dpxD.array() + dpxL.array()
                        + dpxUR.array() + dpxDR.array() + dpxDL.array() + dpxUL.array()) / 8; <i class="conum" data-value="5"></i><b>(5)</b>


        image_t pyU = image_t::Zero(nrows_, ncols_);
        image_t pyR = image_t::Zero(nrows_, ncols_);
        image_t pyD = image_t::Zero(nrows_, ncols_);
        image_t pyL = image_t::Zero(nrows_, ncols_);

        image_t pyUR = image_t::Zero(nrows_, ncols_);
        image_t pyDR = image_t::Zero(nrows_, ncols_);
        image_t pyDL = image_t::Zero(nrows_, ncols_);
        image_t pyUL = image_t::Zero(nrows_, ncols_);

        pyU.block(1, 0, nrows_-1, ncols_) = (py.array().block(0, 0, nrows_-1, ncols_));
        pyR.block(0, 0, nrows_, ncols_-1) = (py.array().block(0, 1, nrows_, ncols_-1));
        pyD.block(0, 0, nrows_-1, ncols_) = (py.array().block(1, 0, nrows_-1, ncols_));
        pyL.block(0, 1, nrows_, ncols_-1) = (py.array().block(0, 0, nrows_, ncols_-1));

        pyUR.block(1, 0, nrows_-1, ncols_-1) = (py.array().block(0, 1, nrows_-1, ncols_-1));
        pyDR.block(0, 0, nrows_-1, ncols_-1) = (py.array().block(1, 1, nrows_-1, ncols_-1));
        pyDL.block(0, 1, nrows_-1, ncols_-1) = (py.array().block(1, 0, nrows_-1, ncols_-1));
        pyUL.block(1, 1, nrows_-1, ncols_-1) = (py.array().block(0, 0, nrows_-1, ncols_-1));


        image_t dpyU = image_t::Zero(nrows_, ncols_);
        image_t dpyR = image_t::Zero(nrows_, ncols_);
        image_t dpyD = image_t::Zero(nrows_, ncols_);
        image_t dpyL = image_t::Zero(nrows_, ncols_);
        image_t dpyUR = image_t::Zero(nrows_, ncols_);
        image_t dpyDR = image_t::Zero(nrows_, ncols_);
        image_t dpyDL = image_t::Zero(nrows_, ncols_);
        image_t dpyUL = image_t::Zero(nrows_, ncols_);

        dpyU = (py.array()-pyU.array()).abs();
        dpyR = (py.array()-pyR.array()).abs();
        dpyD = (py.array()-pyD.array()).abs();
        dpyL = (py.array()-pyL.array()).abs();

        dpyUR = (py.array()-pyUR.array()).abs();
        dpyDR = (py.array()-pyDR.array()).abs();
        dpyDL = (py.array()-pyDL.array()).abs();
        dpyUL = (py.array()-pyUL.array()).abs();

        image_t dpyMean = (dpyU.array() + dpyR.array() + dpyD.array() + dpyL.array()
                        + dpyUR.array() + dpyDR.array() + dpyDL.array() + dpyUL.array()) / 8; <i class="conum" data-value="6"></i><b>(6)</b>

        DphaseSpike_ = (dpxMean.array() &lt; M_PI &amp;&amp; dpyMean.array() &lt; M_PI).select(matrix_1, matrix_0); <i class="conum" data-value="7"></i><b>(7)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Construction of a map with 0 everywhere</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Construction of a 8 maps with 0 everywhere</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Set those 8 maps as a copy of the original phasemap with an offset of one pixel in every possible direction</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Compute the maps of phase differences between original map and its offsets</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Compute the map of mean differences</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Redo steps &lt;1&gt; to &lt;5&gt; for phases along y</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>Selection</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/indicators/PS/PS_surface.png" alt="PS surface">
</div>
<div class="title">Figure 4. Suspect Area</div>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/indicators/PS/PS_phase1.png" alt="PS phase1">
</div>
<div class="title">Figure 5. Phase map along X axis</div>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/indicators/PS/PS_phase2.png" alt="PS phase2">
</div>
<div class="title">Figure 6. Phase map along Y axis</div>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/indicators/PS/PS_result.png" alt="PS result">
</div>
<div class="title">Figure 7. Result of Phase Spike</div>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/indicators/PS/PS_contrast.png" alt="PS contrast">
</div>
<div class="title">Figure 8. Overlapping errors : Low Contrast</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_3_pixels_at_the_edge_of_the_screen"><a class="anchor" href="#_3_pixels_at_the_edge_of_the_screen"></a>3. 3 - Pixels at the edge of the screen</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The focal length of the camera used in Polymap is really short so when the camera sees the fringes by reflection on the surface, they appear as blurred.</p>
</div>
<div class="paragraph">
<p>If the fringes are large enought in comparison to the size of the blur, it does not have a huge impact, we can recognize the shape of a sinus. However for edges pixels, the intensity and the contrast drops quickly.</p>
</div>
<div class="paragraph">
<p>To find those corrupted pixels, we need to find the minimum and maximum values phases can have and find the pixels whose phase is not in these interval</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">double margin = 0.5; <i class="conum" data-value="1"></i><b>(1)</b>

// Horizontal
int nbFringeH = (ncols_ )/fringeLenH ;
auto phaseMinH = - (nbFringeH-margin) * M_PI;
auto phaseMaxH = (nbFringeH-margin) * M_PI;
// Vertical
int nbFringeV = (nrows_ )/fringeLenV ;
auto phaseMinV = - (nbFringeV-margin) * M_PI;
auto phaseMaxV = (nbFringeV-margin) * M_PI;

DphaseBorder_ = ( (px.array() &gt; phaseMinH) &amp;&amp; (px.array() &lt; phaseMaxH)
                &amp;&amp; (py.array() &gt; phaseMinV) &amp;&amp; (py.array() &lt; phaseMaxV) ).select(matrix_1, matrix_0); <i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Small margin to make sure pixels are not exactly at the border of the screen</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Selection</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>In reality, this indicator overlaps the previous ones and will be most of the time with no effects.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/indicators/PB/PB_result.png" alt="PB result">
</div>
<div class="title">Figure 9. Empty indicator</div>
</div>
</div>
</div>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>

  </div>
</main>
</div>
<footer class="footer">
  <div class="container">
    <div class="footer-links">
      <div class="col">
        <div class="footer-logo">
          <a href="https://www.cemosis.fr" class="icon">
            <img src="../../../_/img/logoCemosisTransparent.png" alt="Cemosis">
          </a>
        </div>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://docs.cemosis.fr" target="_blank" rel="noopener">Projects Documentation</a></li>
          <li><a href="https://join.slack.com/t/feelpp/shared_invite/zt-2qe0q9hw-4pVbhohCXUE6Po9Ma8dbiQ" target="_blank" rel="noopener">Forums(Slack)</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://www.cemosis.fr" target="_blank" rel="noopener">Cemosis</a></li>
          <li><a href="https://www.cemosis.fr/news" target="_blank" rel="noopener">News</a></li>
          <li><a href="https://www.cemosis.fr/projects" target="_blank" rel="noopener">Projects</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://docs.feelpp.org" target="_blank" rel="noopener">Feel++ Documentation</a></li>
          <li><a href="http://docs.feelpp.org/user/">Get Started</a></li>
          <li><a href="http://docs.feelpp.org/user//install/distributions/">Downloads</a></li>
        </ul>
      </div>
      <div class="col">
        <ul class="social-icons">
          <li>
            <svg  width="14" height="14" viewBox="0 0 32 32"> <path id="facebook" class="cls-1" d="M29,0H3A2.652,2.652,0,0,0,0,3V29a2.652,2.652,0,0,0,3,3H16V18H12V14h4V12a6.452,6.452,0,0,1,6-6h4v4H22a2.151,2.151,0,0,0-2,2v2h6l-1,4H20V32h9a2.652,2.652,0,0,0,3-3V3A2.652,2.652,0,0,0,29,0Z"/></svg>
            <a href="https://www.facebook.com/cemosis.fr" class="icon">
            Facebook
            </a>
          </li>
          <li>
            <svg  width="14" height="14" viewBox="0 0 32.1 26.1"> <path id="twitter" class="cls-1" d="M32,7.1a11.836,11.836,0,0,1-3.8,1,6.462,6.462,0,0,0,2.9-3.6,12.606,12.606,0,0,1-4.2,1.6A6.492,6.492,0,0,0,22.1,4a6.594,6.594,0,0,0-6.6,6.6,7.719,7.719,0,0,0,.2,1.5A18.458,18.458,0,0,1,2.2,5.2a6.294,6.294,0,0,0-.9,3.3A6.765,6.765,0,0,0,4.2,14a6.109,6.109,0,0,1-3-.8v.1a6.543,6.543,0,0,0,5.3,6.4,4.678,4.678,0,0,1-1.7.2,4.869,4.869,0,0,1-1.2-.1,6.679,6.679,0,0,0,6.1,4.6,12.917,12.917,0,0,1-8.2,2.8,9.151,9.151,0,0,1-1.6-.1,18.438,18.438,0,0,0,10.1,3c12.1,0,18.7-10,18.7-18.7v-.8A13.336,13.336,0,0,0,32,7.2Z" transform="translate(0.1 -4)"/></svg>
            <a href="https://twitter.com/cemosis" class="icon">
              Twitter
            </a>
          </li>
          <li>
          <svg  width="14" height="14" viewBox="0 0 32 32"> <path id="linkedin" class="cls-1" d="M29,0H3A3.076,3.076,0,0,0,0,3V29a3.009,3.009,0,0,0,3,3H29a2.946,2.946,0,0,0,3-3V3A3.009,3.009,0,0,0,29,0ZM12,26H8V12h4ZM10,10a2,2,0,1,1,2-2A2.006,2.006,0,0,1,10,10ZM26,26H22V18a2,2,0,0,0-4,0v8H14V12h4v2.5c.8-1.1,2.1-2.5,3.5-2.5A4.736,4.736,0,0,1,26,17Z"/></svg>
              <a href="https://www.linkedin.com/company/cemosis" class="icon">
             Linkedin
            </a>
          </li>
        </ul>
      </div>
    </div>
    <div class="footer-terms">
      <div class="footer-terms-copyright">
          <span>© 2020 Cemosis, Université de Strasbourg</span>
      </div>
      <div class="footer-terms-links">
        <a href="https://www.cemosis.fr/terms-of-use">Terms of Use</a>
        <a href="https://www.cemosis.fr/privacy-policy">Privacy Policy</a>
        <a href="https://www.cemosis.fr/cookie-policy">Cookie Policy</a>
        <a href="https://www.cemosis.fr/support-policy">Support Policy</a>
      </div>
    </div>
  </div>
</footer>
<script src="../../../_/js/site.js"></script>
<script async src="../../../_/js/vendor/fontawesome-icon-defs.js"></script>
<script async src="../../../_/js/vendor/fontawesome.js"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>

<script async id="search-script" src="../../../_/js/vendor/docsearch.js" data-app-id="FIPLENFG5M" data-api-key="489d96aa4ae574ec7ad1f23741a2d46d" data-index-name="cemosis" data-stylesheet="../../../_/css/vendor/docsearch.css">
</script>

  </body>
</html>
