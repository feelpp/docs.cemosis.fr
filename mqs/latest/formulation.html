<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Formulation :: Cemosis Docs</title>
    <link rel="canonical" href="https://docs.cemosis.fr/mqs/latest/formulation.html">
    <meta name="generator" content="Antora 2.3.3">
    <link rel="stylesheet" href="../../_/css/site.css">
<link rel="icon" href="../../_/img/favicon.ico" type="image/x-icon">    
<script>!function(l,p){if(l.protocol!==p&&l.host=="docs.antora.org"){l.protocol=p}else if(/\.gitlab\.io$/.test(l.host)){l.replace(p+"//docs.antora.org"+l.pathname.substr(l.pathname.indexOf("/",1))+l.search+l.hash)}}(location,"https:")</script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$'], ['\\[','\\]']],
    processEscapes: true,
    processEnvironments: true, 
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },

  TeX: {
      Macros: {
      RR: "{\\mathbb R}",
      NN: "{\\mathbb N}",
      Nso: "{N_{\\mathrm{so}}}",
      Nma: "{N_{\\mathrm{ma}}}",
      Nno: "{N_{\\mathrm{no}}}",
      Ne: "{N_{\\mathrm{e}}}",
      Ilag: ["{\\mathcal{I}^{\\mathrm{lag}}_{#1}}",1],
      calTh: "{\\mathcal{T}_h}",
      Ck: ["{\\mathcal{C}^{#1}}",1],
      Pk: ["{\\mathcal{P}^{#1}}",1],
      Qk: ["{\\mathcal{Q}^{#1}}",1],
      Pch: ["{P^{#1}_{c,h}}",1],
      Pcho: ["{P^{#1}_{c,h,0}}",1],
      Qch: ["{Q^{#1}_{c,h}}",1],
      Ich: ["{\\mathcal{I}^{#1}_{c,h}#2}",2],
      poly: ["{\\mathbb{#1}}",1],
      nf: "{n_f}",
      ngeo: "{n_{\\mathrm{geo}}}",
      geo: "{\\mathrm{geo}}",
      card: ["{\\operatorname{card}(#1)}",1],
      dim: ["{\\operatorname{dim}(#1)}",1],
      opdim: "{\\operatorname{dim}}",
      card: ["{\\operatorname{card}(#1)}",1],
      poly: ["{\\mathbb{#1}",1],
      R: ["{\\mathbb{R}^{#1}}",1],
      set: ["{\\left\\{#1\\right\\}}",1],
      diam: "{\\operatorname{diam}}",
      jump: ["{[\\![ #1 ]\\!]}",1],
      Next: "{\\mathrm{n}}",
      essinf: "{\\operatorname{ess}\\, \\operatorname{inf}}",
      tr: "{\\operatorname{tr}}",
      Id: "{\\mathcal{I}}",
      disp: ["{\\mathbf{#1}}",1],
      stresst: ["{\\mathbf{\\sigma(#1)}}",1],
      deformt: ["{\\mathbf{\\varepsilon(#1)}}",1],
      domain: "{\\Omega}",
      prect: ["{\\left\\(#1\\right\\)}",1],
      ds: "",
      bold: ["{\\bf #1}",1],
      p: "{\\mathrm{p}}",
      q:"{\\mathbf{q}}",
      n:"{\\mathbf{n}}",
      T:"{\\mathcal{T}}",
      F:"{\\mathcal{F}}",
      P:"{\\mathcal{P}}",
      v:"{\\mathbf{v}}"
  },
  extensions: ["mhchem.js"] }
});
</script>
<!--<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/MathJax.js?config=TeX-MML-AM_CHTML"></script>-->
<!-- <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML' async></script> -->
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_CHTML'>
</script>
<!--<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.6.0/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>-->

<!--<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0/katex.min.css" integrity="sha384-TEMocfGvRuD1rIAacqrknm5BQZ7W7uWitoih+jMNFXQIbNl16bO8OZmylH/Vi/Ei" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0/katex.min.js" integrity="sha384-jmxIlussZWB7qCuB+PgKG1uLjjxbVVIayPJwi6cG6Zb4YKq0JIw+OMnkkEC7kYCq" crossorigin="anonymous"></script>-->

    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-65761593-2"></script>
    <script>function gtag(){dataLayer.push(arguments)};window.dataLayer=window.dataLayer||[];gtag('js',new Date());gtag('config','UA-65761593-2')</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar  navbar-expand-sm bg-dark navbar-dark">
    <div class="navbar-brand">
      <div class="navbar-item">
         <!--  <a href="https://book.feelpp.org">Feel++ documentation</a> -->
           <a href="https://docs.cemosis.fr">Cemosis Docs</a>
      </div>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://docs.cemosis.fr">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <div class="navbar-link">Docs</div>
          <div class="navbar-dropdown">
            <div class="navbar-item"><strong>Latest Version</strong></div>

            <!-- this code allow to manage ordering of navbar item -->
               
              <a class="navbar-item" href="/cemosis/latest/index.html"> Cemosis Documentation </a>
                  
              <a class="navbar-item" href="/antora-ui-default/index.html"> Cemosis Documentation UI </a>
                  
              <a class="navbar-item" href="/eye2brain/current/index.html"> Eye2Brain Manual </a>
                  
              <a class="navbar-item" href="/feelpp-cfd/latest/index.html"> Feel++ CFD </a>
                  
              <a class="navbar-item" href="/mqs/latest/index.html"> Feel++ Maxwell Quasi Static </a>
                  
              <a class="navbar-item" href="/hemotumpp/0.1/index.html"> HemoTum++ </a>
                  
              <a class="navbar-item" href="/hifimagnet/stable/index.html"> HiFiMagnet Documentation </a>
                  
              <a class="navbar-item" href="/holo3/latest/index.html"> Holo3 </a>
                    
              <a class="navbar-item" href="/ibat/latest/index.html"> IBat Docs </a>
                  
              <a class="navbar-item" href="/msqab/0.1/index.html"> msqab </a>
                  
              <a class="navbar-item" href="/swimmer/latest/index.html"> Swimmer Docs </a>
               

            <hr class="navbar-divider">
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <div class="navbar-link">Feel++</div>
          <div class="navbar-dropdown">
            <div class="navbar-item"><strong>GitHub</strong></div>
            <a class="navbar-item" href="http://github.com/feelpp/feelpp">GitHub Repository</a>
            <a class="navbar-item" href="http://github.com/feelpp/feelpp/issues">GitHub Issue Tracker</a>
            <hr class="navbar-divider">
            <div class="navbar-item"><strong>Documentation</strong></div>
            <a class="navbar-item" href="http://docs.feelpp.org/user/">User Manual</a>
            <a class="navbar-item" href="http://docs.feelpp.org/dev/">Developer Manual</a>
            <a class="navbar-item" href="http://docs.feelpp.org/toolbox/">Toolbox Manual</a>
            
          </div>
        </div>
        <div class="primary-action">
            <form class="navbar-item search">
              <input type="text" placeholder="Search Cemosis Docs" class="query" id="search-query">
              <button type="button" class="search-btn"><i class="fas fa-search"></i></button>
            </form>
        </div>
        <div class="navbar-item">
          <a class="navbar-brand" href="https://join.slack.com/t/feelpp/shared_invite/zt-2qe0q9hw-4pVbhohCXUE6Po9Ma8dbiQ">
            <img src="../../_/img/slack.png" alt="slack" style="width:30px;"></a>
        </div>
        <div class="navbar-item">
          <a class="navbar-brand"  href="http://docs.feelpp.org">
            <img src="../../_/img/logoFeelpp.png" alt="Feel++" style="width:60px;">
          </a>
        </div>
        <div class="navbar-item">
          <a class="navbar-brand"  href="http://www.cemosis.fr">
            <img src="../../_/img/logoCemosisTransparent.png" alt="Cemosis" style="width:60px;">
          </a>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="mqs" data-version="latest">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html">Feel++ Maxwell Quasi Static</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">MQS</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Outline of the project</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="front.html">Modeling the transient behavior of high field magnets</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="index.html">Introduction</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="formulation.html">Formulation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="discretization.html">Discretization</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="implementation.html">Implementation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="validation.html">Validations</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="conclusion.html">Conclusion</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="acknowledgments.html">Acknowledgments</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="code.html">Code</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="bibliography.html">Bibliography</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="appendix.html">Appendix</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Roadmap</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="roadmap.html">Roadmap</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">References</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#toolboxes:maxwell:mqs/README.adoc">Eddy Currents</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">MQS stage</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Outline of the project</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="stage/front.html">Modeling the transient behavior of high field magnets</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="stage/index.html">Introduction</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="stage/formulation.html">Maxwell&#8217;s equations and MQS approximation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="stage/validation.html">Validations</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="stage/endimple.html">End of the project, beginning and objective of the stage</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="stage/results.html">Implementation of MQS equations and results</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="stage/bdf.html">Backward differentiation formula</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="stage/mqsheat.html">Add the heat equation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="stage/resolution1.html">Linear resolution</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="stage/resolution2.html">Non-linear resolution</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="stage/appendix.html">Appendix</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Feel++ Maxwell Quasi Static</span>
    <span class="version">latest</span>
  </div>
  <ul class="components">
    <li class="component">
      <span class="title">Cemosis Documentation</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../cemosis/latest/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Cemosis Documentation UI</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../antora-ui-default/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Eye2Brain Manual</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../eye2brain/current/index.html">current</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Feel++ CFD</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../feelpp-cfd/latest/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <span class="title">Feel++ Maxwell Quasi Static</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">HemoTum++</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../hemotumpp/0.1/index.html">0.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">HiFiMagnet Documentation</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../hifimagnet/stable/index.html">stable</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Holo3</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../holo3/latest/index.html">latest</a>
        </li>
        <li class="version">
          <a href="../../holo3/doc-pierre/index.html">doc-pierre</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">IBat Docs</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../ibat/latest/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">msqab</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../msqab/0.1/index.html">0.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Swimmer Docs</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../swimmer/latest/index.html">latest</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../cemosis/latest/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">Feel++ Maxwell Quasi Static</a></li>
    <li>MQS</li>
    <li>Outline of the project</li>
    <li><a href="formulation.html">Formulation</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/feelpp/mqs/edit/master/docs/modules/ROOT/pages/formulation.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<article class="doc">
<h1 class="page">Formulation</h1>
<div class="sect1">
<h2 id="_differential_form_of_maxwells_equations"><a class="anchor" href="#_differential_form_of_maxwells_equations"></a>1. Differential form of Maxwell&#8217;s equations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Maxwell&#8217;s equations, are laws of physics, constituting the basic postulates of electromagnetism. They translate, in local form, several theorems that governed electromagnetism, that Maxwell gathered in integral form.
These equations define relations between the electromagnetic fields and the source elements.
The differential form of Maxwell&#8217;s equations is as follows:</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{align*}
\nabla \times H(r,t) &amp;=&amp; J(r,t) + \frac{\partial D(r,t)}{\partial t} \\
\nabla \times E(r,t) &amp;=&amp; -\frac{\partial B(r,t)}{\partial t} \\
\nabla \cdot B(r,t) &amp;=&amp; 0 \\
\nabla \cdot D(r,t) &amp;=&amp; \rho(r,t) \\
B(r,t) &amp;=&amp; \mu_0[H(r,t)+M(r,t)] \\
J(r,t) &amp;=&amp; \sigma[E(r,t)+E_i(r,t)] \\
D(r,t) &amp;=&amp; \epsilon_0 E(r,t) + P(r,t)
\end{align*}\]
</div>
</div>
<div class="paragraph">
<p>where :</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(H(r,t)\)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the magnetic field intensity,</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(E(r,t)\)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the electric field intensity,</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(B(r,t)\)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the magnetic flux density,</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(D(r,t)\)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the electric flux density,</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(J(r,t)\)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the electric current density,</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(\rho(r,t)\)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the electric charge density,</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(M(r,t)\)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the magnetization,</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(E_i(r,t)\)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the impressed electric field,</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(P(r,t)\)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the polarization,</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(\mu_0(r,t)\)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the permeability of vaccum,</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(\sigma(r,t)\)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the conductivity,</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(\epsilon_0(r,t)\)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the permittivity of vacuum.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_the_magnetic_vector_and_electric_scalar_potentials_formulation"><a class="anchor" href="#_the_magnetic_vector_and_electric_scalar_potentials_formulation"></a>2. The magnetic vector and electric scalar potentials formulation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We&#8217;re interested in simplified equations:</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{align*}
\nabla \times H(r,t) &amp;=&amp; J(r,t) + \frac{\partial D(r,t)}{\partial t} \\
\nabla \times E(r,t) &amp;=&amp; -\frac{\partial B(r,t)}{\partial t} \\
\nabla \cdot B(r,t) &amp;=&amp; 0 \\
\nabla \cdot D(r,t) &amp;=&amp; 0 \\
B(r,t) &amp;=&amp; \mu_0H(r,t) \\
D(r,t) &amp;=&amp; \epsilon_0 E(r,t) \\
J(r,t) &amp;=&amp; \sigma E(r,t)
\end{align*}\]
</div>
</div>
<div class="paragraph">
<p>The MQS approximation consists in neglecting the so-called displacement current, aka \(\frac{\partial D}{\partial t}\). In this context, the equations to solve are:</p>
</div>
<div class="paragraph">
<p><a id="Faraday"></a><a id="Ampere"></a></p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{align}
\nabla \times H(r,t) &amp;=&amp; J(r,t),\label{Ampere} \\
\nabla \times E(r,t) &amp;=&amp; -\frac{\partial B(r,t)}{\partial t}, \label{Faraday} \\
B(r,t) &amp;=&amp; \mu_0H(r,t) \\
J(r,t) &amp;=&amp; \sigma\,E(r,t)
\end{align}\]
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The first two equations are respectively the so-called <strong>Ampere</strong> and <strong>Faraday</strong> equations.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A classical way to solve these equations is to introduce a magnetic potential \(A\) and a scalar electric potential \(V\). As \(B\) is a divergence free field, we can define \(A\) as:</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation*}
B = \nabla \times A.
\end{equation*}\]
</div>
</div>
<div class="paragraph">
<p>To ensure \(A\) unicity we will need to add a gauge condition. Most commonly:</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation*}
\nabla \cdot A = 0
\end{equation*}\]
</div>
</div>
<div class="paragraph">
<p>The <a href="#Faraday">Faraday equation</a> may, then, be rewritten as:</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation*}
\nabla \times (E +\frac{\partial A}{\partial t} ) = 0.
\end{equation*}\]
</div>
</div>
<div class="paragraph">
<p>We can define the electric scalar potential \(V\) as:</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation*}
E +\frac{\partial A}{\partial t} = -\nabla V.
\end{equation*}\]
</div>
</div>
<div class="paragraph">
<p>It follows that:</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation*}
J = \sigma ( -\nabla V -\frac{\partial A}{\partial t}).
\end{equation*}\]
</div>
</div>
<div class="paragraph">
<p>From this expression of the current density, we may rewrite the <a href="#Ampere">Ampere equation</a> as:</p>
</div>
<div id="nAmpere" class="stemblock">
<div class="content">
\[\begin{equation}
\nabla \times (\frac{1}{\mu}\,\nabla \times A) + \sigma  \frac{\partial A}{\partial t} = -\sigma \, \nabla V.\quad\text{(1)}\label{nAmpere}
\end{equation}\]
</div>
</div>
<div class="paragraph">
<p>because :</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation*}
B = \nabla \times A = \mu H
\end{equation*}\]
</div>
</div>
<div class="paragraph">
<p>so :</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation*}
\nabla \times H = \nabla \times ( \frac{1}{\mu} \nabla \times A)
\end{equation*}\]
</div>
</div>
<div class="paragraph">
<p>To this equation, we add the conservation of the current density:</p>
</div>
<div id="nConservation" class="stemblock">
<div class="content">
\[\begin{equation}
\nabla \cdot (J) = \nabla \cdot (\sigma ( -\nabla V -\frac{\partial A}{\partial t})) = 0\quad\text{(2)}
\end{equation}\label{nConservation}\]
</div>
</div>
<div class="paragraph">
<p>Equations <a href="#nAmpere">(1)</a> and <a href="#nConservation">(2)</a> are the equations that we will solve for the MQS model.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_weak_formulation"><a class="anchor" href="#_weak_formulation"></a>3. Weak formulation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Let us note \(\Omega\) the domain, comprising the conductor \(\Omega_C\) and the air \(\Omega_A\), and let us note \(\Gamma\) the edge of this domain, comprising the edge of the air \(\Gamma_A\), the inlet \(\Gamma_I\) and the outlet \(\Gamma_O\). To simplify, let us note \(\Gamma_D\) the edges with Dirichlet boundary condition, and \(\Gamma_N\) the edges with Neumann bondary condition, such that \(\Gamma = \Gamma_D \cup \Gamma_N\).</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/Weak_f/domain1.png" alt="geometry" width="50%"></span></p>
</div>
<div class="paragraph">
<p>We can also have a second case where the edges \(\Gamma_I\) and \(\Gamma_O\) are on \(\Gamma_A\), where we can impose Dirichlet boundary condition.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/Weak_f/domain2.png" alt="geometry" width="50%"></span></p>
</div>
<div class="paragraph">
<p>Let&#8217;s look at the set:</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation}
H^{curl}(\Omega) = \{v \in L^2(\Omega)| \nabla \times v \in L^2(\Omega)\}
\end{equation}\]
</div>
</div>
<div class="paragraph">
<p>and let define the set containing Dirichlet&#8217;s boundary condition :</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation}
H_{A_D}^{curl}(\Omega) = \{v \in H^{curl}(\Omega)| v \times n = A_D \text{ on } \Gamma_D\}
\end{equation}\]
</div>
</div>
<div class="paragraph">
<p>We can now distinguish two cases. First, if the edges are not curved, we have the following case, where \(A_D = 0\) :</p>
</div>
<div class="paragraph">
<p>Let us consider the equation <a href="#nAmpere">(1)</a> : By making the scalar product with \(\phi \in H_{A_D}^{curl}(\Omega)\) and by integrating on \(\Omega\) we get :</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation}
\int_{\Omega} \phi \cdot (\nabla \times (\frac{1}{\mu}\,\nabla \times A) + \sigma  \frac{\partial A}{\partial t}) = \int_{\Omega_C} \phi \cdot (-\sigma \, \nabla V)
\end{equation}\]
</div>
</div>
<div class="paragraph">
<p>Using the relationship:</p>
</div>
<div class="stemblock">
<div class="content">
\[\nabla \cdot (u \times v) = v \cdot (\nabla \times u) - u \cdot (\nabla \times v)\]
</div>
</div>
<div class="paragraph">
<p>we deduce that:</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation}
\int_{\Omega} \frac{1}{\mu} \, (\nabla \times \phi) \cdot (\nabla \times A) + \int_{\Omega} \frac{1}{\mu} \nabla \cdot (\phi \times (\nabla \times A)) = - \int_{\Omega_C} \sigma \phi \cdot (\nabla V + \frac{\partial A}{\partial t})
\end{equation}\]
</div>
</div>
<div class="paragraph">
<p>Using the divergence theorem we get:</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation}
\int_{\Omega} \frac{1}{\mu} \, (\nabla \times \phi) \cdot (\nabla \times A) + \int_{\Gamma_D} \frac{1}{\mu} (\phi \times (\nabla \times A))\cdot n + \int_{\Gamma_N} \frac{1}{\mu} (\phi \times (\nabla \times A))\cdot n = - \int_{\Omega_C} \sigma \phi \cdot (\nabla V + \frac{\partial A}{\partial t})
\end{equation}\]
</div>
</div>
<div class="paragraph">
<p>By performing a circular permutation on \(\Gamma_N\) and \(\Gamma_D\) we have :</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation}
\int_{\Omega} \frac{1}{\mu} \, (\nabla \times \phi) \cdot (\nabla \times A) - \int_{\Gamma_D} \frac{1}{\mu} (\phi \times n) \cdot (\nabla \times A) + \int_{\Gamma_N} \frac{1}{\mu} ((\nabla \times A) \times n ) \cdot \phi = - \int_{\Omega_C} \sigma \phi \cdot (\nabla V + \frac{\partial A}{\partial t})
\end{equation}\]
</div>
</div>
<div class="paragraph">
<p>On \(\Gamma_N\) we impose homogeneous Neumann boundary conditions \(B \times n = 0\) since \(B = \nabla \times A\). This condition typically apply for physical symetry on some bounday (cf 1/8 of a torus example). So \((\nabla \times A) \times n = 0\) on \(\Gamma_N\). On \(\Gamma_D\) we impose Dirichlet boundary condition \( \phi \times n = A_D\), where \(A_D\) is known.</p>
</div>
<div class="paragraph">
<p>In the case where edges are not curved, we have \( \phi \times n = A_D = 0\).
So we finally get the weak formulation:</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation}
\int_{\Omega} \frac{1}{\mu} \, (\nabla \times \phi) \cdot (\nabla \times A) = - \int_{\Omega_C} \sigma \phi \cdot (\nabla V + \frac{\partial A}{\partial t})
\end{equation}\]
</div>
</div>
<div class="paragraph">
<p>In the second case, were we have curved edges, we concider that \( \phi \times n = A_D\), where \(A_D\) is known.</p>
</div>
<div class="paragraph">
<p>So we have :</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation}
\int_{\Omega} \frac{1}{\mu} \, (\nabla \times \phi) \cdot (\nabla \times A) - \int_{\Gamma_D} \frac{1}{\mu} A_D \cdot (\nabla \times A) = - \int_{\Omega_C} \sigma \phi \cdot (\nabla V + \frac{\partial A}{\partial t})
\end{equation}\]
</div>
</div>
<div class="paragraph">
<p>The border of \(\Omega_C\) is considered to be splitted into \(\Gamma_I\), \(\Gamma_O\) respectively the input and output of current and the rest will be noted \(\Gamma_C\). On \(\Gamma_I\) and \(\Gamma_O\) we consider Dirichlet Boundary condition for the electrical potential. Thus we will take \(\psi \in H^1(\Omega_C)\).</p>
</div>
<div class="paragraph">
<p>Let&#8217;s consider the equation <a href="#nConservation">(2)</a> : By making the scalar product with \(\psi\) and integrating over \(\Omega_C\) we get :</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation}
\int_{\Omega_C} \psi \cdot \nabla \cdot (\sigma ( -\nabla V -\frac{\partial A}{\partial t})) = 0
\end{equation}\]
</div>
</div>
<div class="paragraph">
<p>Using the relationship:</p>
</div>
<div class="stemblock">
<div class="content">
\[\nabla \cdot (u \cdot v) = v \cdot \nabla u + u \nabla \cdot v\]
</div>
</div>
<div class="paragraph">
<p>we get :</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation}
\int_{\Omega_C} \nabla \cdot (\sigma \psi \cdot ( -\nabla V -\frac{\partial A}{\partial t})) - \int_{\Omega_C} \sigma ( -\nabla V -\frac{\partial A}{\partial t}) \cdot \nabla \psi = 0
\end{equation}\]
</div>
</div>
<div class="paragraph">
<p>By using the formula of divergence we get:</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation}
\int_{\Gamma_C} \sigma \psi \cdot ( -\nabla V -\frac{\partial A}{\partial t}) \cdot n - \int_{\Omega_C} \sigma ( -\nabla V -\frac{\partial A}{\partial t}) \cdot \nabla \psi = 0
\end{equation}\]
</div>
</div>
<div class="paragraph">
<p>Or we know that \(j \cdot n = 0\) on \(\Gamma_C\) due to the current density conservation law. Or \(j = \sigma E = \sigma(\nabla V + \frac{\partial A}{\partial t})\) so we get finally :</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation}
 - \int_{\Omega_C} \sigma ( -\nabla V -\frac{\partial A}{\partial t}) \cdot \nabla \psi = 0
\end{equation}\]
</div>
</div>
</div>
</div>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>

  </div>
</main>
</div>
<footer class="footer">
  <div class="container">
    <div class="footer-links">
      <div class="col">
        <div class="footer-logo">
          <a href="https://www.cemosis.fr" class="icon">
            <img src="../../_/img/logoCemosisTransparent.png" alt="Cemosis">
          </a>
        </div>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://docs.cemosis.fr" target="_blank" rel="noopener">Projects Documentation</a></li>
          <li><a href="https://join.slack.com/t/feelpp/shared_invite/zt-2qe0q9hw-4pVbhohCXUE6Po9Ma8dbiQ" target="_blank" rel="noopener">Forums(Slack)</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://www.cemosis.fr" target="_blank" rel="noopener">Cemosis</a></li>
          <li><a href="https://www.cemosis.fr/news" target="_blank" rel="noopener">News</a></li>
          <li><a href="https://www.cemosis.fr/projects" target="_blank" rel="noopener">Projects</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://docs.feelpp.org" target="_blank" rel="noopener">Feel++ Documentation</a></li>
          <li><a href="http://docs.feelpp.org/user/">Get Started</a></li>
          <li><a href="http://docs.feelpp.org/user//install/distributions/">Downloads</a></li>
        </ul>
      </div>
      <div class="col">
        <ul class="social-icons">
          <li>
            <svg  width="14" height="14" viewBox="0 0 32 32"> <path id="facebook" class="cls-1" d="M29,0H3A2.652,2.652,0,0,0,0,3V29a2.652,2.652,0,0,0,3,3H16V18H12V14h4V12a6.452,6.452,0,0,1,6-6h4v4H22a2.151,2.151,0,0,0-2,2v2h6l-1,4H20V32h9a2.652,2.652,0,0,0,3-3V3A2.652,2.652,0,0,0,29,0Z"/></svg>
            <a href="https://www.facebook.com/cemosis.fr" class="icon">
            Facebook
            </a>
          </li>
          <li>
            <svg  width="14" height="14" viewBox="0 0 32.1 26.1"> <path id="twitter" class="cls-1" d="M32,7.1a11.836,11.836,0,0,1-3.8,1,6.462,6.462,0,0,0,2.9-3.6,12.606,12.606,0,0,1-4.2,1.6A6.492,6.492,0,0,0,22.1,4a6.594,6.594,0,0,0-6.6,6.6,7.719,7.719,0,0,0,.2,1.5A18.458,18.458,0,0,1,2.2,5.2a6.294,6.294,0,0,0-.9,3.3A6.765,6.765,0,0,0,4.2,14a6.109,6.109,0,0,1-3-.8v.1a6.543,6.543,0,0,0,5.3,6.4,4.678,4.678,0,0,1-1.7.2,4.869,4.869,0,0,1-1.2-.1,6.679,6.679,0,0,0,6.1,4.6,12.917,12.917,0,0,1-8.2,2.8,9.151,9.151,0,0,1-1.6-.1,18.438,18.438,0,0,0,10.1,3c12.1,0,18.7-10,18.7-18.7v-.8A13.336,13.336,0,0,0,32,7.2Z" transform="translate(0.1 -4)"/></svg>
            <a href="https://twitter.com/cemosis" class="icon">
              Twitter
            </a>
          </li>
          <li>
          <svg  width="14" height="14" viewBox="0 0 32 32"> <path id="linkedin" class="cls-1" d="M29,0H3A3.076,3.076,0,0,0,0,3V29a3.009,3.009,0,0,0,3,3H29a2.946,2.946,0,0,0,3-3V3A3.009,3.009,0,0,0,29,0ZM12,26H8V12h4ZM10,10a2,2,0,1,1,2-2A2.006,2.006,0,0,1,10,10ZM26,26H22V18a2,2,0,0,0-4,0v8H14V12h4v2.5c.8-1.1,2.1-2.5,3.5-2.5A4.736,4.736,0,0,1,26,17Z"/></svg>
              <a href="https://www.linkedin.com/company/cemosis" class="icon">
             Linkedin
            </a>
          </li>
        </ul>
      </div>
    </div>
    <div class="footer-terms">
      <div class="footer-terms-copyright">
          <span>© 2020 Cemosis, Université de Strasbourg</span>
      </div>
      <div class="footer-terms-links">
        <a href="https://www.cemosis.fr/terms-of-use">Terms of Use</a>
        <a href="https://www.cemosis.fr/privacy-policy">Privacy Policy</a>
        <a href="https://www.cemosis.fr/cookie-policy">Cookie Policy</a>
        <a href="https://www.cemosis.fr/support-policy">Support Policy</a>
      </div>
    </div>
  </div>
</footer>
<script src="../../_/js/site.js"></script>
<script async src="../../_/js/vendor/fontawesome-icon-defs.js"></script>
<script async src="../../_/js/vendor/fontawesome.js"></script>
<script async src="../../_/js/vendor/highlight.js"></script>

<script async id="search-script" src="../../_/js/vendor/docsearch.js" data-app-id="FIPLENFG5M" data-api-key="489d96aa4ae574ec7ad1f23741a2d46d" data-index-name="cemosis" data-stylesheet="../../_/css/vendor/docsearch.css">
</script>

  </body>
</html>
