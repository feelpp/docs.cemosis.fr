<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Linear resolution :: Cemosis Docs</title>
    <link rel="canonical" href="https://docs.cemosis.fr/mqs/latest/stage/resolution1.html">
    <meta name="generator" content="Antora 2.3.3">
    <link rel="stylesheet" href="../../../_/css/site.css">
<link rel="icon" href="../../../_/img/favicon.ico" type="image/x-icon">    
<script>!function(l,p){if(l.protocol!==p&&l.host=="docs.antora.org"){l.protocol=p}else if(/\.gitlab\.io$/.test(l.host)){l.replace(p+"//docs.antora.org"+l.pathname.substr(l.pathname.indexOf("/",1))+l.search+l.hash)}}(location,"https:")</script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$'], ['\\[','\\]']],
    processEscapes: true,
    processEnvironments: true, 
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },

  TeX: {
      Macros: {
      RR: "{\\mathbb R}",
      NN: "{\\mathbb N}",
      Nso: "{N_{\\mathrm{so}}}",
      Nma: "{N_{\\mathrm{ma}}}",
      Nno: "{N_{\\mathrm{no}}}",
      Ne: "{N_{\\mathrm{e}}}",
      Ilag: ["{\\mathcal{I}^{\\mathrm{lag}}_{#1}}",1],
      calTh: "{\\mathcal{T}_h}",
      Ck: ["{\\mathcal{C}^{#1}}",1],
      Pk: ["{\\mathcal{P}^{#1}}",1],
      Qk: ["{\\mathcal{Q}^{#1}}",1],
      Pch: ["{P^{#1}_{c,h}}",1],
      Pcho: ["{P^{#1}_{c,h,0}}",1],
      Qch: ["{Q^{#1}_{c,h}}",1],
      Ich: ["{\\mathcal{I}^{#1}_{c,h}#2}",2],
      poly: ["{\\mathbb{#1}}",1],
      nf: "{n_f}",
      ngeo: "{n_{\\mathrm{geo}}}",
      geo: "{\\mathrm{geo}}",
      card: ["{\\operatorname{card}(#1)}",1],
      dim: ["{\\operatorname{dim}(#1)}",1],
      opdim: "{\\operatorname{dim}}",
      card: ["{\\operatorname{card}(#1)}",1],
      poly: ["{\\mathbb{#1}",1],
      R: ["{\\mathbb{R}^{#1}}",1],
      set: ["{\\left\\{#1\\right\\}}",1],
      diam: "{\\operatorname{diam}}",
      jump: ["{[\\![ #1 ]\\!]}",1],
      Next: "{\\mathrm{n}}",
      essinf: "{\\operatorname{ess}\\, \\operatorname{inf}}",
      tr: "{\\operatorname{tr}}",
      Id: "{\\mathcal{I}}",
      disp: ["{\\mathbf{#1}}",1],
      stresst: ["{\\mathbf{\\sigma(#1)}}",1],
      deformt: ["{\\mathbf{\\varepsilon(#1)}}",1],
      domain: "{\\Omega}",
      prect: ["{\\left\\(#1\\right\\)}",1],
      ds: "",
      bold: ["{\\bf #1}",1],
      p: "{\\mathrm{p}}",
      q:"{\\mathbf{q}}",
      n:"{\\mathbf{n}}",
      T:"{\\mathcal{T}}",
      F:"{\\mathcal{F}}",
      P:"{\\mathcal{P}}",
      v:"{\\mathbf{v}}"
  },
  extensions: ["mhchem.js"] }
});
</script>
<!--<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/MathJax.js?config=TeX-MML-AM_CHTML"></script>-->
<!-- <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML' async></script> -->
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_CHTML'>
</script>
<!--<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.6.0/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>-->

<!--<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0/katex.min.css" integrity="sha384-TEMocfGvRuD1rIAacqrknm5BQZ7W7uWitoih+jMNFXQIbNl16bO8OZmylH/Vi/Ei" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0/katex.min.js" integrity="sha384-jmxIlussZWB7qCuB+PgKG1uLjjxbVVIayPJwi6cG6Zb4YKq0JIw+OMnkkEC7kYCq" crossorigin="anonymous"></script>-->

    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-65761593-2"></script>
    <script>function gtag(){dataLayer.push(arguments)};window.dataLayer=window.dataLayer||[];gtag('js',new Date());gtag('config','UA-65761593-2')</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar  navbar-expand-sm bg-dark navbar-dark">
    <div class="navbar-brand">
      <div class="navbar-item">
         <!--  <a href="https://book.feelpp.org">Feel++ documentation</a> -->
           <a href="https://docs.cemosis.fr">Cemosis Docs</a>
      </div>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://docs.cemosis.fr">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <div class="navbar-link">Docs</div>
          <div class="navbar-dropdown">
            <div class="navbar-item"><strong>Latest Version</strong></div>

            <!-- this code allow to manage ordering of navbar item -->
               
              <a class="navbar-item" href="/cemosis/latest/index.html"> Cemosis Documentation </a>
                  
              <a class="navbar-item" href="/antora-ui-default/index.html"> Cemosis Documentation UI </a>
                  
              <a class="navbar-item" href="/eye2brain/current/index.html"> Eye2Brain Manual </a>
                  
              <a class="navbar-item" href="/feelpp-cfd/latest/index.html"> Feel++ CFD </a>
                  
              <a class="navbar-item" href="/mqs/latest/index.html"> Feel++ Maxwell Quasi Static </a>
                  
              <a class="navbar-item" href="/hemotumpp/0.1/index.html"> HemoTum++ </a>
                  
              <a class="navbar-item" href="/hifimagnet/stable/index.html"> HiFiMagnet Documentation </a>
                  
              <a class="navbar-item" href="/holo3/latest/index.html"> Holo3 </a>
                    
              <a class="navbar-item" href="/ibat/latest/index.html"> IBat </a>
                  
              <a class="navbar-item" href="/msqab/0.1/index.html"> msqab </a>
                  
              <a class="navbar-item" href="/swimmer/latest/index.html"> Swimmer Docs </a>
               

            <hr class="navbar-divider">
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <div class="navbar-link">Feel++</div>
          <div class="navbar-dropdown">
            <div class="navbar-item"><strong>GitHub</strong></div>
            <a class="navbar-item" href="http://github.com/feelpp/feelpp">GitHub Repository</a>
            <a class="navbar-item" href="http://github.com/feelpp/feelpp/issues">GitHub Issue Tracker</a>
            <hr class="navbar-divider">
            <div class="navbar-item"><strong>Documentation</strong></div>
            <a class="navbar-item" href="http://docs.feelpp.org/user/">User Manual</a>
            <a class="navbar-item" href="http://docs.feelpp.org/dev/">Developer Manual</a>
            <a class="navbar-item" href="http://docs.feelpp.org/toolbox/">Toolbox Manual</a>
            
          </div>
        </div>
        <div class="primary-action">
            <form class="navbar-item search">
              <input type="text" placeholder="Search Cemosis Docs" class="query" id="search-query">
              <button type="button" class="search-btn"><i class="fas fa-search"></i></button>
            </form>
        </div>
        <div class="navbar-item">
          <a class="navbar-brand" href="https://join.slack.com/t/feelpp/shared_invite/zt-2qe0q9hw-4pVbhohCXUE6Po9Ma8dbiQ">
            <img src="../../../_/img/slack.png" alt="slack" style="width:30px;"></a>
        </div>
        <div class="navbar-item">
          <a class="navbar-brand"  href="http://docs.feelpp.org">
            <img src="../../../_/img/logoFeelpp.png" alt="Feel++" style="width:60px;">
          </a>
        </div>
        <div class="navbar-item">
          <a class="navbar-brand"  href="http://www.cemosis.fr">
            <img src="../../../_/img/logoCemosisTransparent.png" alt="Cemosis" style="width:60px;">
          </a>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="mqs" data-version="latest">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Feel++ Maxwell Quasi Static</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">MQS</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Outline of the project</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../front.html">Modeling the transient behavior of high field magnets</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../index.html">Introduction</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../formulation.html">Formulation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../discretization.html">Discretization</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../implementation.html">Implementation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../validation.html">Validations</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../conclusion.html">Conclusion</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../acknowledgments.html">Acknowledgments</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../code.html">Code</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../bibliography.html">Bibliography</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../appendix.html">Appendix</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Roadmap</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../roadmap.html">Roadmap</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">References</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#toolboxes:maxwell:mqs/README.adoc">Eddy Currents</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">MQS stage</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Outline of the project</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="front.html">Modeling the transient behavior of high field magnets</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="index.html">Introduction</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="formulation.html">Maxwell&#8217;s equations and MQS approximation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="validation.html">Validations</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="endimple.html">End of the project, beginning and objective of the stage</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="results.html">Implementation of MQS equations and results</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="bdf.html">Backward differentiation formula</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="mqsheat.html">Add the heat equation</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="resolution1.html">Linear resolution</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="resolution2.html">Non-linear resolution</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="appendix.html">Appendix</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Feel++ Maxwell Quasi Static</span>
    <span class="version">latest</span>
  </div>
  <ul class="components">
    <li class="component">
      <span class="title">Cemosis Documentation</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../cemosis/latest/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Cemosis Documentation UI</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../antora-ui-default/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Eye2Brain Manual</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../eye2brain/current/index.html">current</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Feel++ CFD</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../feelpp-cfd/latest/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <span class="title">Feel++ Maxwell Quasi Static</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">HemoTum++</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../hemotumpp/0.1/index.html">0.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">HiFiMagnet Documentation</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../hifimagnet/stable/index.html">stable</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Holo3</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../holo3/latest/index.html">latest</a>
        </li>
        <li class="version">
          <a href="../../../holo3/doc-pierre/index.html">doc-pierre</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">IBat</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../ibat/latest/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">msqab</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../msqab/0.1/index.html">0.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Swimmer Docs</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../swimmer/latest/index.html">latest</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../cemosis/latest/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Feel++ Maxwell Quasi Static</a></li>
    <li>MQS stage</li>
    <li>Outline of the project</li>
    <li><a href="resolution1.html">Linear resolution</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/feelpp/mqs/edit/master/docs/modules/stage/pages/resolution1.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<article class="doc">
<h1 class="page">Linear resolution</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>As we have seen at the end of the previous paragraph,
a first way to solve the problem is to first solve the mqs equations and then solve the heat equation,
assuming it is linear.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_theoretical_results"><a class="anchor" href="#_theoretical_results"></a>1. Theoretical results</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Let&#8217;s go over our heat equation again :</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation*}
\rho Cp\frac{\partial T}{\partial t} - \nabla \cdot ( k \nabla T) = f
\end{equation*}\]
</div>
</div>
<div class="paragraph">
<p>Here we are only interested in the stationary solution in a hollow cylindrical area.  We
Let us further assume that T is only a function of r .
Let&#8217;s note U the potential difference applied to the edges of the magnet.
In this case, the second member becomes :</p>
</div>
<div class="stemblock">
<div class="content">
\[f=\sigma (\frac{U}{2\pi r})^2\]
</div>
</div>
<div class="paragraph">
<p>So the equation becomes :</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation*}
 -\frac{1}{r}\frac{\partial}{\partial r}(rk \frac{\partial T}{\partial r}) = \sigma (\frac{U}{2\pi r})^2
\end{equation*}\]
</div>
</div>
<div class="paragraph">
<p>By integrating, we obtain :</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation*}
rk \frac{\partial T}{\partial r} = -\sigma (\frac{U}{2\pi})^2 \ln(r) + Ak
\end{equation*}\]
</div>
</div>
<div class="paragraph">
<p>where \(A\) is a constant.
By reintegrating, we finally find :</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation*}
T = A \ln(r) - \frac{\sigma}{2k} (\frac{U}{2\pi})^2 \ln^2(r) + B
\end{equation*}\]
</div>
</div>
<div class="paragraph">
<p>Where B is a constant.
The constants A and B will be determined by the boundary conditions applied to the internal radius \(r_1\) and external radius \(r_2\) of the magnet.</p>
</div>
<div class="paragraph">
<p>Now let&#8217;s look for the maximum temperature.
This is obtained when \(r\) is such that \(\frac{\partial T}{\partial r}=0\).
We must therefore solve the equation :</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation*}
A - \frac{\sigma}{k} (\frac{U}{2\pi})^2 \ln(r) = 0
\end{equation*}\]
</div>
</div>
<div class="paragraph">
<p>where the solution is :</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation*}
r=e^{\frac{Ak}{\sigma (\frac{U}{2\pi})^2}}
\end{equation*}\]
</div>
</div>
<div class="paragraph">
<p>so :</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation*}
T_{max} = \frac{A^2k}{2\sigma (\frac{U}{2\pi})^2 } + B = 0
\end{equation*}\]
</div>
</div>
<div class="paragraph">
<p>Now, let&#8217;s assume that the boundary conditions are Robin-type, that is:</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation*}
-k\frac{\partial T}{\partial n} = h(r)(T(r)-T_w(r))
\end{equation*}\]
</div>
</div>
<div class="paragraph">
<p>with n the normal unit outside the magnet.
In addition, let&#8217;s note \(h_1=h(r_1)\), \(h_2=h(r_2)\), \(T_1=T_w(r_1)\) and \(T_2=T_w(r_2)\).</p>
</div>
<div class="paragraph">
<p>Applying Robin&#8217;s conditions to the previously found solution T, we obtain :</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{align}
A(-k-h_2r_2\ln(r_2))-Bh_2r_2 = - \frac{\sigma}{2k} (\frac{U}{2\pi})^2 \ln(r_2)(h_2r_2\ln(r_2) + 2k) -h_2r_2T_2 \\
A(k-h_1r_1\ln(r_1))-Bh_1r_1 = - \frac{\sigma}{2k} (\frac{U}{2\pi})^2 \ln(r_1)(h_1r_1\ln(r_1) - 2k) -h_1r_2T_1
\end{align}\]
</div>
</div>
<div class="paragraph">
<p>So :</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation*}
A = \frac{\sigma}{2k} (\frac{U}{2\pi})^2 \frac{ \frac{1}{2} \ln(r_1r_2)\ln(\frac{r_1}{r_2}) + k(\frac{\ln(r_2)}{h_2r_2} + \frac{\ln(r_1)}{h_1r_1})}{ k(\frac{1}{h_2r_2} + \frac{1}{h_1r_1})+\ln(\frac{r_2}{r_1}) } + \frac{T_2 - T_1}{ k(\frac{1}{h_2r_2} + \frac{1}{h_1r_1})+\ln(\frac{r_2}{r_1}) }
\end{equation*}\]
</div>
</div>
<div class="paragraph">
<p>So:</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation*}
T=B-\frac{\sigma}{2k} (\frac{U}{2\pi})^2 \ln^2(\frac{r}{r_0}) + \frac{T_2 - T_1}{ k(\frac{1}{h_2r_2} + \frac{1}{h_1r_1})+\ln(\frac{r_2}{r_1}) }\ln(r)
\end{equation*}\]
</div>
</div>
<div class="paragraph">
<p>with</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation*}
\ln(r_0) = \frac{ \frac{1}{2} \ln(r_1r_2)\ln(\frac{r_1}{r_2}) + k(\frac{\ln(r_2)}{h_2r_2} + \frac{\ln(r_1)}{h_1r_1})}{ k(\frac{1}{h_2r_2} + \frac{1}{h_1r_1})+\ln(\frac{r_2}{r_1}) }
\end{equation*}\]
</div>
</div>
<div class="paragraph">
<p>If \(T_2=T_1\) we have :</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation*}
T=B-\frac{\sigma}{2k} (\frac{U}{2\pi})^2 \ln^2(\frac{r}{r_0})
\end{equation*}\]
</div>
</div>
<div class="paragraph">
<p>It can therefore be seen that \(B=T_{max}\) and \(r_0=r_{max}\)</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_under_feelpp"><a class="anchor" href="#_implementation_under_feelpp"></a>2. Implementation under feelpp</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now let&#8217;s implement the first method, first solving the two equations mqs,
then solving the heat equation, assuming that \(k\) and \(\sigma\) are linear,
and with the source term \(f=\frac{1}{\sigma} ||J||^2\).</p>
</div>
<div class="paragraph">
<p>To do this, we will "assemble" the mqs bdf and heat codes.</p>
</div>
<div class="paragraph">
<p>For the mqs part, it&#8217;s exactly the same as in the BDF part.</p>
</div>
<div class="paragraph">
<p>For the heat part, there are some changes.
First, we define \(T\) on the conductor.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">auto Th = Pch&lt;1&gt;( mesh, markedelements(mesh, range) );</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then, after solving the mqs equations and calculating the term J,
the heat equation is solved as in the heat part, using the source term J</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">l1 += integrate(_range=markedelements(cond_mesh, material.meshMarkers()),
	            _expr = (1/sigma) * id(T) * inner(idv(J_cond)+idv(J_induct),idv(J_cond)+idv(J_induct)) );</code></pre>
</div>
</div>
<div class="paragraph">
<p>We then solve this second equation and start again at the following time step .</p>
</div>
<div class="paragraph">
<p>All the code is available in the mqsheatweak.cpp file in the heat branch.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_results"><a class="anchor" href="#_results"></a>3. Results</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To verify the code, we will perform a simulation on the one solenoidal magnet case,
the same as in the validation part.</p>
</div>
<div class="paragraph">
<p>After a simulation using the following command line :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cmd hljs" data-lang="cmd">mpirun -np 8 feelpp_mqs_heatmqs --config-file cases/mqsheat/mqsheatweak.cfg --gmsh.hsize=2.5e-3 --pc-type gasm</code></pre>
</div>
</div>
<div class="paragraph">
<p>with the config file</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cfg hljs" data-lang="cfg">directory=mqs/mqsheatweak

#init solution
A0={0,0,0}
V0=0
T0=293

model-file=$cfgdir/mqsheatweak.json

[gmsh]
hsize=5.e-3
filename=$cfgdir/mqsheatweak.geo
partition=1

[mqs]
ksp-monitor=false
#pc-type=gamg
pc-type=fieldsplit
fieldsplit-type=additive #additive, multiplicative, symmetric-multiplicative

[mqs.fieldsplit-0]
pc-type=gamg
[mqs.fieldsplit-1]
pc-type=gamg

#[exporter]
#geometry=static

[ts]
time-step=0.1
time-final=22

[bdf]
time-step=0.1
time-final=22</code></pre>
</div>
</div>
<div class="paragraph">
<p>and the json file</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cfg hljs" data-lang="cfg">{
    "Name": "CoupledCart",
    "ShortName":"MSC",
    "Models":
    {
	    "use-model-name":1,
	    "solid":
	    {
	        "equations":"Elasticity"
	    },
        "maxwell":
        {
	        "equations":"magnetostatic-cart"
	    }
    },
    "Parameters":
    {
	"Tau":"1",
	"V0": "0",
	"V1": "1*1/4."
    },
    "Materials":
    {
        "copper":
        {
            "markers":"coil",
	    "physics":["heat","electric","solid","maxwell"],
            "sigma":"58.e+6",
            "mu_mag": "1",
            "Cp":"380",
            "rho":"10000",
            "k":"380"

        },
        "air":
        {
            "markers":"air",
	    "physics":["maxwell"],
            "mu_mag": "1",
            "Cp":"1004",
            "k":"0.0262",
            "rho":"1.292"

        }
    },
    "BoundaryConditions":
    {
        "electric-potential":
        {
            "Dirichlet":
            {
                "V0":
                {
                    "expr":"0"
                },
                "V1":
                {
                    "expr":"1/4.*t/(0.1*10)*(t&lt;(0.1*10))+(1/4.*(t&lt;(0.5*40))+0*(t&gt;(0.5*40)))*(t&gt;(0.1*10)):t"
		}
            }
        },
        "magnetic-potential":
        {
            "Dirichlet":
            {
                "Border":
                {
                    "expr":"{0,0,0}"
                }
            },
            "DirichletX":
            {
                "V0":
                {
                    "expr":"0"
                },
		"OXOZ":
                {
                    "expr":"0"
                }
            },
            "DirichletY":
            {
                "V1":
                {
                    "expr":"0"
                },
		"OYOZ":
                {
                    "expr":"0"
                }
            },
            "DirichletZ":
            {
                "V0":
                {
                    "expr":"0"
                },
		"OXOZ":
                {
                    "expr":"0"
                },
                "V1":
                {
                    "expr":"0"
                },
		"OYOZ":
                {
                    "expr":"0"
                }
            }
        },
        "temperature":
        {
            "Robin":
            {
                "Rint":
                {
                    "expr1":"80000", <i class="conum" data-value="1"></i><b>(1)</b>
                    "expr2":"293" <i class="conum" data-value="2"></i><b>(2)</b>
                },
                "Rext":
                {
                    "expr1":"80000",
                    "expr2":"293"
                }
            }
        }
    },
    "PostProcess":
    {
	"Exports":
	{
	    "fields":["magneticPotential","magneticField","temperature"]
	}
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>k in robin condition</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Tw in robin condition</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This is what we get for \(Bz\) and \(I\) :</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/mqsheat/weakbzi.png" alt="geometry" width="50%"></span></p>
</div>
<div class="paragraph">
<p>We are tending towards the same values as the resolution part.</p>
</div>
<div class="paragraph">
<p>Now let&#8217;s take a look at the temperature results.</p>
</div>
<div class="paragraph">
<p>First, here&#8217;s what we get for the temperature in the simulation, at the point \((0,r_0,0)\),
where \(r_0\) is the same as in the theoretical part.
We have \(r_1=0.075\), \(r_2=0.1002\), \(h_1=h_2=80000\), \(k=380\), so \(r_0 \approx 0.086109025458\)</p>
</div>
<div class="paragraph">
<p>Here is what we get for the temperature at point \((0,r_0,0)\):</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/mqsheat/weakT.png" alt="geometry" width="50%"></span></p>
</div>
<div class="paragraph">
<p>We can see that at the end of the plateau, which is equivalent to the stationary regime,
the temperature is approximately \(363.4095126K\).</p>
</div>
<div class="paragraph">
<p>The expected theoretical result, calulated with the result in the theorical part is \(T=363.702800489573K\),
which is very close to what we have.</p>
</div>
<div class="paragraph">
<p>Now let&#8217;s compare the temperature according to the radius, at the end of the plateau in stationary mode.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/mqsheat/weakTr.png" alt="geometry" width="50%"></span></p>
</div>
<div class="paragraph">
<p>We can see that our results are very close to the theoretical result,
which shows that the code is working correctly.</p>
</div>
<div class="paragraph">
<p>So we can see that, on the one hand, the results of the mqs part are satisfactory,
because they are the same as what we obtained at the beginning,
and the heat equation also gives the expected results.
Now we can talk about the second case, namely the resolution of the mqs equations first,
and then the resolution of the non-linear heat equation using a fixed point method</p>
</div>
</div>
</div>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>

  </div>
</main>
</div>
<footer class="footer">
  <div class="container">
    <div class="footer-links">
      <div class="col">
        <div class="footer-logo">
          <a href="https://www.cemosis.fr" class="icon">
            <img src="../../../_/img/logoCemosisTransparent.png" alt="Cemosis">
          </a>
        </div>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://docs.cemosis.fr" target="_blank" rel="noopener">Projects Documentation</a></li>
          <li><a href="https://join.slack.com/t/feelpp/shared_invite/zt-2qe0q9hw-4pVbhohCXUE6Po9Ma8dbiQ" target="_blank" rel="noopener">Forums(Slack)</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://www.cemosis.fr" target="_blank" rel="noopener">Cemosis</a></li>
          <li><a href="https://www.cemosis.fr/news" target="_blank" rel="noopener">News</a></li>
          <li><a href="https://www.cemosis.fr/projects" target="_blank" rel="noopener">Projects</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://docs.feelpp.org" target="_blank" rel="noopener">Feel++ Documentation</a></li>
          <li><a href="http://docs.feelpp.org/user/">Get Started</a></li>
          <li><a href="http://docs.feelpp.org/user//install/distributions/">Downloads</a></li>
        </ul>
      </div>
      <div class="col">
        <ul class="social-icons">
          <li>
            <svg  width="14" height="14" viewBox="0 0 32 32"> <path id="facebook" class="cls-1" d="M29,0H3A2.652,2.652,0,0,0,0,3V29a2.652,2.652,0,0,0,3,3H16V18H12V14h4V12a6.452,6.452,0,0,1,6-6h4v4H22a2.151,2.151,0,0,0-2,2v2h6l-1,4H20V32h9a2.652,2.652,0,0,0,3-3V3A2.652,2.652,0,0,0,29,0Z"/></svg>
            <a href="https://www.facebook.com/cemosis.fr" class="icon">
            Facebook
            </a>
          </li>
          <li>
            <svg  width="14" height="14" viewBox="0 0 32.1 26.1"> <path id="twitter" class="cls-1" d="M32,7.1a11.836,11.836,0,0,1-3.8,1,6.462,6.462,0,0,0,2.9-3.6,12.606,12.606,0,0,1-4.2,1.6A6.492,6.492,0,0,0,22.1,4a6.594,6.594,0,0,0-6.6,6.6,7.719,7.719,0,0,0,.2,1.5A18.458,18.458,0,0,1,2.2,5.2a6.294,6.294,0,0,0-.9,3.3A6.765,6.765,0,0,0,4.2,14a6.109,6.109,0,0,1-3-.8v.1a6.543,6.543,0,0,0,5.3,6.4,4.678,4.678,0,0,1-1.7.2,4.869,4.869,0,0,1-1.2-.1,6.679,6.679,0,0,0,6.1,4.6,12.917,12.917,0,0,1-8.2,2.8,9.151,9.151,0,0,1-1.6-.1,18.438,18.438,0,0,0,10.1,3c12.1,0,18.7-10,18.7-18.7v-.8A13.336,13.336,0,0,0,32,7.2Z" transform="translate(0.1 -4)"/></svg>
            <a href="https://twitter.com/cemosis" class="icon">
              Twitter
            </a>
          </li>
          <li>
          <svg  width="14" height="14" viewBox="0 0 32 32"> <path id="linkedin" class="cls-1" d="M29,0H3A3.076,3.076,0,0,0,0,3V29a3.009,3.009,0,0,0,3,3H29a2.946,2.946,0,0,0,3-3V3A3.009,3.009,0,0,0,29,0ZM12,26H8V12h4ZM10,10a2,2,0,1,1,2-2A2.006,2.006,0,0,1,10,10ZM26,26H22V18a2,2,0,0,0-4,0v8H14V12h4v2.5c.8-1.1,2.1-2.5,3.5-2.5A4.736,4.736,0,0,1,26,17Z"/></svg>
              <a href="https://www.linkedin.com/company/cemosis" class="icon">
             Linkedin
            </a>
          </li>
        </ul>
      </div>
    </div>
    <div class="footer-terms">
      <div class="footer-terms-copyright">
          <span>© 2020 Cemosis, Université de Strasbourg</span>
      </div>
      <div class="footer-terms-links">
        <a href="https://www.cemosis.fr/terms-of-use">Terms of Use</a>
        <a href="https://www.cemosis.fr/privacy-policy">Privacy Policy</a>
        <a href="https://www.cemosis.fr/cookie-policy">Cookie Policy</a>
        <a href="https://www.cemosis.fr/support-policy">Support Policy</a>
      </div>
    </div>
  </div>
</footer>
<script src="../../../_/js/site.js"></script>
<script async src="../../../_/js/vendor/fontawesome-icon-defs.js"></script>
<script async src="../../../_/js/vendor/fontawesome.js"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>

<script async id="search-script" src="../../../_/js/vendor/docsearch.js" data-app-id="FIPLENFG5M" data-api-key="489d96aa4ae574ec7ad1f23741a2d46d" data-index-name="cemosis" data-stylesheet="../../../_/css/vendor/docsearch.css">
</script>

  </body>
</html>
